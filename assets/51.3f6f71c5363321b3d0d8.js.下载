(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{717:function(t,e,s){"use strict";s.r(e);var i=s(31),a=s(36);function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function n(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){Object(i.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var r={name:"EmojiModal",components:{},props:{visible:{type:Boolean,default:!1}},data:function(){return{activeTabName:"0"}},computed:n({},Object(a.d)("common",{expressionList:"emojiList"})),watch:{},created:function(){},mounted:function(){this.getEmojiList()},methods:n(n({},Object(a.c)("common",["getEmojiList"])),{},{close:function(){this.$emit("update:visible",!1)},chooseEmoji:function(t){this.$emit("add",t),this.close(),window.AnalysysAgent.track("post_emoji_add_click",{emoji_name:t})}})},c=s(20),l=Object(c.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:t.visible,title:"添加表情","close-on-click-modal":!1,"before-close":t.close,"lock-scroll":!1,"append-to-body":!0},on:{"update:visible":function(e){t.visible=e}}},[s("el-tabs",{staticClass:"relative -top-20",model:{value:t.activeTabName,callback:function(e){t.activeTabName=e},expression:"activeTabName"}},t._l(t.expressionList,(function(e,i){return s("el-tab-pane",{key:i,attrs:{label:e.title,name:""+i}},[s("ul",{staticClass:"grid grid-cols-6 gap-2"},t._l(e.emoji,(function(e,i){return s("li",{key:i,staticClass:"cursor-pointer",on:{click:function(s){return t.chooseEmoji(e.img)}}},[s("img",{attrs:{src:e.img,alt:""}})])})),0)])})),1)],1)}),[],!1,null,"78631b7a",null);e.default=l.exports},729:function(t,e,s){"use strict";s.r(e);s(71),s(157),s(49),s(391),s(93),s(39),s(72),s(57);var i={name:"PostModal",components:{},props:{visible:{type:Boolean,default:!1},ifUpdate:{type:Boolean,default:!1},postId:{type:[String,Number],default:0}},data:function(){return{limitImgNumber:9,emojiModalVisible:!1,tagModalVisible:!1,ifDisabled:!1,postData:{type:11,title:"",content:""},imgsList:[],tagList:[]}},computed:{},watch:{},created:function(){},mounted:function(){this.getPostData()},methods:{getPostData:function(){var t=this;this.ifUpdate&&this.$apiRepository.post.getPostInfo({post_id:this.postId}).then((function(e){t.postData.type=e.post.type,t.postData.title=e.post.title,t.postData.content=e.post.content.replace(/<br>/g,"\n"),t.tagList=JSON.parse(e.post.tag_json),e.post.imgs&&""!==e.post.imgs&&(t.imgsList=e.post.imgs.split(/[;`]/))}))},addSuccess:function(t){this.imgsList.push(t)},removeImg:function(t){this.imgsList.splice(t,1)},addEmoji:function(){this.imgsList.length<this.limitImgNumber?this.emojiModalVisible=!this.emojiModalVisible:this.$message({type:"warning",message:"图片最多添加".concat(this.limitImgNumber,"张"),offset:300})},addTags:function(){this.tagModalVisible=!0},renderTags:function(t){this.tagList=t.tagList},checkData:function(){return""===this.postData.title?(this.$message.warning("请填写标题"),!1):""===this.postData.content.replace(/[\s\n\r]/g,"")?(this.$message.warning("文本内容不能为空"),!1):0===this.tagList.length?(this.$message.warning("请选择标签"),!1):!(this.tagList.length>5)||(this.$message.warning("至多5个标签"),!1)},confirm:function(){var t=this;if(!this.checkData())return!1;var e=this.$utils.filterHtmlTag(this.postData.title),s=this.$utils.filterHtmlTag(this.postData.content),i={post_id:this.postId,type:this.postData.type,title:e,content:s.replace(/[\n\r]/g,"<br>"),tag_ids:this.tagList.map((function(t){return t.id})).join("`")};this.imgsList.length>0&&(i.imgs=this.imgsList.join("`")),this.ifUpdate?this.$apiRepository.limit.postUpdate(i).then((function(e){t.$message.success("修改成功"),window.AnalysysAgent.track("post_send",{post_id:"".concat(e.post_id),post_type:"".concat(i.type),post_title:i.title,post_tag_ids:t.tagList.map((function(t){return String(t.id)})),if_post_have_picture:!!i.imgs||!1}),window.location.href="".concat(t.$settings.routePre,"/post/").concat(e.post_id),t.close()})).catch((function(e){var s=e.response.data.retMsg&&void 0!==e.response.data.retMsg?e.response.data.retMsg:null;t.$message.error(s||"修改失败")})):this.$apiRepository.post.postCreate(i).then((function(e){t.$message.success("发布成功"),window.AnalysysAgent.track("post_send",{post_id:"".concat(e.post_id),post_type:"".concat(i.type),post_title:i.title,post_tag_ids:t.tagList.map((function(t){return String(t.id)})),if_post_have_picture:!!i.imgs||!1}),window.location.href="".concat(t.$settings.routePre,"/post/").concat(e.post_id),t.close()})).catch((function(e){var s=e.response.data.retMsg&&void 0!==e.response.data.retMsg?e.response.data.retMsg:null;t.$message.error(s||"创建失败")}))},close:function(){this.postData={type:11,title:"",content:""},this.imgsList=[],this.$emit("update:visible",!1)}}},a=s(20),o=Object(a.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{width:"600px",visible:t.visible,title:t.ifUpdate?"修改帖子":"发帖","lock-scroll":!1,"close-on-click-modal":!1,"before-close":t.close,"append-to-body":!0},on:{"update:visible":function(e){t.visible=e}}},[s("div",[s("el-select",{attrs:{placeholder:"请选择帖子类型",disabled:t.ifDisabled},model:{value:t.postData.type,callback:function(e){t.$set(t.postData,"type",e)},expression:"postData.type"}},[s("el-option",{attrs:{label:"普通帖子",value:11}}),t._v(" "),s("el-option",{attrs:{label:"问答帖子",value:16}})],1)],1),t._v(" "),s("div",{staticClass:"mt-20"},[s("el-input",{attrs:{placeholder:"标题不超过30个字符"},model:{value:t.postData.title,callback:function(e){t.$set(t.postData,"title",e)},expression:"postData.title"}})],1),t._v(" "),s("div",{staticClass:"mt-10"},[s("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"点击输入文本内容，图片最多添加"+t.limitImgNumber+"张"},model:{value:t.postData.content,callback:function(e){t.$set(t.postData,"content",e)},expression:"postData.content"}})],1),t._v(" "),t.imgsList.length>0?s("div",{staticClass:"mt-10 flex flex-row flex-wrap items-center"},t._l(t.imgsList,(function(e,i){return s("div",{key:i,staticClass:"relative mr-10 mb-10 bg-cover bg-center bg-no-repeat",staticStyle:{width:"80px",height:"80px"},style:{backgroundImage:"url("+e+")"}},[s("el-button",{staticClass:"absolute top-0 right-0",attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.removeImg(i)}}})],1)})),0):t._e(),t._v(" "),t.tagList.length>0?s("div",{staticClass:"mt-10 flex flex-row flex-wrap items-center"},t._l(t.tagList,(function(t,e){return s("TagView",{key:e,staticClass:"mr-10 mb-10",attrs:{"tag-name":t.tag}})})),1):t._e(),t._v(" "),s("div",{staticClass:"mt-10"},[s("FileUploadBtn",{attrs:{"btn-size":"mini",msg:"添加图片","if-disabled":t.imgsList.length>=t.limitImgNumber},on:{uploadSuccess:t.addSuccess}}),t._v(" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-picture-outline",disabled:t.imgsList.length>=t.limitImgNumber},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addEmoji(e)}}},[t._v("添加表情")]),t._v(" "),s("el-button",{attrs:{size:"mini",icon:"el-icon-collection-tag"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addTags(e)}}},[t._v("选择标签")]),t._v(" "),t.emojiModalVisible?s("EmojiModal",{attrs:{visible:t.emojiModalVisible},on:{"update:visible":function(e){t.emojiModalVisible=e},add:t.addSuccess}}):t._e(),t._v(" "),t.tagModalVisible?s("TagModal",{attrs:{visible:t.tagModalVisible,"has-choose-list":t.tagList,"tag-limit":5},on:{"update:visible":function(e){t.tagModalVisible=e},back:t.renderTags}}):t._e()],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.confirm}},[t._v(t._s(t.ifUpdate?"确认修改":"发布"))])],1)])}),[],!1,null,"30551bc6",null);e.default=o.exports;installComponents(o,{TagView:s(713).default,FileUploadBtn:s(716).default,EmojiModal:s(717).default,TagModal:s(718).default})},748:function(t,e,s){"use strict";s.r(e);s(93);var i={name:"ReportModal",components:{},props:{visible:{type:Boolean,default:!1},sourceId:{type:[String,Number],default:""},sourceType:{type:Number,default:1}},data:function(){return{reportType:-1,desc:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{close:function(){this.reportType=-1,this.desc="",this.$emit("update:visible",!1)},confirm:function(){var t=this;if(this.reportType<0)return this.$message({type:"warning",message:"请选择举报类型",offset:300}),!1;var e={source_id:this.sourceId,source_type:this.sourceType,report_type:this.reportType,report_content:this.desc};this.$apiRepository.comment.contentReport(e).then((function(){t.$message({type:"success",message:"举报成功",offset:300})})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})})),this.close()}}},a=s(20),o=Object(a.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:t.visible,title:"举报","lock-scroll":!1,"before-close":t.close,"append-to-body":!0},on:{"update:visible":function(e){t.visible=e}}},[s("div",{staticClass:"text-base mb-10"},[t._v("举报类型")]),t._v(" "),s("el-radio-group",{model:{value:t.reportType,callback:function(e){t.reportType=e},expression:"reportType"}},[s("el-radio",{attrs:{label:1}},[t._v("垃圾营销")]),t._v(" "),s("el-radio",{attrs:{label:2}},[t._v("淫秽色情")]),t._v(" "),s("el-radio",{attrs:{label:3}},[t._v("不实消息")]),t._v(" "),s("el-radio",{attrs:{label:4}},[t._v("人身攻击")]),t._v(" "),s("el-radio",{attrs:{label:5}},[t._v("违法信息")]),t._v(" "),s("el-radio",{attrs:{label:9}},[t._v("其他")])],1),t._v(" "),s("div",{staticClass:"mt-20 mb-10 text-base"},[t._v("描述")]),t._v(" "),s("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"更详实的描述可以加速审理流程"},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}}),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.confirm}},[t._v("确认举报")])],1)],1)}),[],!1,null,"897dae54",null);e.default=o.exports},795:function(t,e,s){},796:function(t,e,s){},797:function(t,e,s){},798:function(t,e,s){},807:function(t,e,s){},808:function(t,e,s){},809:function(t,e,s){},810:function(t,e,s){},811:function(t,e,s){},812:function(t,e,s){},813:function(t,e,s){},814:function(t,e,s){},815:function(t,e,s){},836:function(t,e,s){"use strict";s.r(e);s(94),s(157),s(49),s(93),s(39),s(123),s(72);var i=s(31),a=s(36);function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}var n={name:"PostOperateBox",components:{},props:{postId:{type:[String,Number],default:""},post:{type:Object,default:function(){return{}}},postType:{type:[String,Number],default:""},author:{type:Object,default:function(){return{}}}},data:function(){return{operateType:{top:1,cancelTop:2,recommend:3,addToFeed:4,edit:5,delete:6,report:7},topModalVisible:!1,topTagList:[],postRemunerationVisible:!1,postModalVisible:!1,reportModalVisible:!1,tagModalVisible:!1,moduleId:"",recommendVisible:!1}},fetch:function(){this.$store.dispatch("tag/setModuleList")},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){Object(i.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({tagList:function(){return""!==this.post.tag_json?JSON.parse(this.post.tag_json):[]},hasAuth:function(){return this.$store.getters.userInfo.id===this.author.id}},Object(a.d)("tag",["tempPostTagList","moduleList"])),watch:{},created:function(){},mounted:function(){},methods:{operate:function(t){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;switch(t){case this.operateType.top:this.toTop();break;case this.operateType.cancelTop:this.cancelTop();break;case this.operateType.recommend:this.toRecommend();break;case this.operateType.addToFeed:this.toAddToFeed();break;case this.operateType.edit:this.toEdit();break;case this.operateType.delete:this.toDelete();break;case this.operateType.report:this.toReport()}},toTop:function(){this.tagList.length>0?this.topModalVisible=!0:this.$message({type:"info",message:"该帖不能被置顶",offset:300})},cancelTop:function(){var t=this,e={post_id:Number(this.postId),tag_id:this.tagList.map((function(t){return t.id})).join("`"),sort_no:-1};this.$apiRepository.limit.postTop(e).then((function(e){t.$message({type:"success",message:"已取消置顶",offset:300});var s=window.location.href;window.location.href=s})).catch((function(e){t.$message.error(e.response.data.retMsg||"取消置顶失败")}))},chooseTag:function(t){this.topTagList.map((function(t){return t.id})).includes(t.id)||this.topTagList.push(t)},top:function(){var t=this;if(0===this.topTagList.length)return this.$message({type:"warning",message:"请选择置顶位置所属标签"}),!1;var e={post_id:Number(this.postId),tag_id:this.topTagList.map((function(t){return t.id})).join("`"),sort_no:1};this.$apiRepository.limit.postTop(e).then((function(e){t.$message({type:"success",message:"置顶成功",offset:300});var s=window.location.href;window.location.href=s})).catch((function(e){t.$message.error(e.response.data.retMsg||"置顶失败")}))},toRecommend:function(){this.recommendVisible=!0},recommend:function(){var t=this;if(!this.moduleId)return this.$message.warning("请选择推荐版块"),!1;var e={post_id:Number(this.postId),module_id:this.moduleId};this.$apiRepository.limit.postRecommend(e).then((function(e){t.$message({type:"success",message:"推荐成功",offset:300}),t.recommendVisible=!1;var s=window.location.href;window.location.href=s})).catch((function(e){t.$message.error(e.response.data.retMsg||"推荐失败")}))},toAddToFeed:function(){this.tagModalVisible=!0},addToFeed:function(t){var e=this,s=t.module_id||this.post.module_id,i=t.tagList.map((function(t){return t.id})).join("`"),a={post_id:Number(this.postId),tag_id:i,module_id:s};this.$apiRepository.limit.postToFeed(a).then((function(t){e.$message({type:"success",message:"推荐到推荐流成功",offset:300});var s=window.location.href;window.location.href=s})).catch((function(t){e.$message.error(t.response.data.retMsg||"添加到资讯流失败")}))},toEdit:function(){var t=Number(this.postType);[11,16].includes(t)?this.postModalVisible=!0:13===t?this.$message({type:"warning",message:"请前往投稿平台修改",offset:300}):this.$message({type:"warning",message:"当前帖子类型不支持编辑修改",offset:300})},toDelete:function(){var t=this;this.$confirm("删除该帖子, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$apiRepository.limit.postDelete({post_ids:t.postId}).then((function(e){t.$message({type:"success",message:"删除成功",offset:300}),t.$router.go(-1)})).catch((function(e){t.$message.error(e.response.data.retMsg||"删除失败")}))})).catch((function(){}))},toReport:function(){this.reportModalVisible=!0}}},r=(s(883),s(20)),c=Object(r.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-operate-box-component"},[s("div",{staticClass:"operate-list"},[s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.topOrRevokePost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.topOrRevokePost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.top)}}},[t._v("置顶")]),t._v(" "),s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.topOrRevokePost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.topOrRevokePost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.cancelTop)}}},[t._v("取消置顶")]),t._v(" "),s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.recommendPost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.recommendPost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.recommend)}}},[t._v("推荐帖子")]),t._v(" "),t.post.feed_created?t._e():s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.addFeedPost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.addFeedPost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.addToFeed)}}},[t._v("添加到资讯流")]),t._v(" "),t.hasAuth?s("div",[s("div",{staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.edit)}}},[t._v("编辑")]),t._v(" "),t.post.feed_created?t._e():s("div",{staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.delete)}}},[t._v("删除")])]):s("div",[s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.modifyPost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.modifyPost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.edit)}}},[t._v("编辑")]),t._v(" "),t.post.feed_created?t._e():s("div",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.deletePost},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.deletePost }"}],staticClass:"operate-item",on:{click:function(e){return t.operate(t.operateType.delete)}}},[t._v("删除")])]),t._v(" "),s("div",{staticClass:"operate-item border-t-0",on:{click:function(e){return t.operate(t.operateType.report)}}},[t._v("举报")])]),t._v(" "),t.topModalVisible?s("el-dialog",{attrs:{visible:t.topModalVisible,title:"选择标签置顶",width:"500px","lock-scroll":!1,"append-to-body":!0},on:{"update:visible":function(e){t.topModalVisible=e}}},[s("div",{staticClass:"space-x-10 space-y-2"},t._l(t.tagList,(function(e,i){return s("el-tag",{key:i,staticClass:"cursor-pointer",attrs:{effect:"plain"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.chooseTag(e)}}},[t._v("\n        "+t._s(e.tag)+"\n      ")])})),1),t._v(" "),t.topTagList.length?s("div",{staticClass:"mt-20"},[s("div",[t._v("已选标签")]),t._v(" "),s("div",{staticClass:"mt-10 space-x-10 space-y-2"},t._l(t.topTagList,(function(e,i){return s("el-tag",{key:i,attrs:{effect:"dark",closable:""},on:{close:function(e){return t.topTagList.splice(i,1)}}},[t._v("\n          "+t._s(e.tag)+"\n        ")])})),1)]):t._e(),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.top}},[t._v("确 定")])],1)]):t._e(),t._v(" "),t.recommendVisible?s("el-dialog",{attrs:{visible:t.recommendVisible,title:"选择推荐版块",width:"500px","lock-scroll":!1,"append-to-body":!0},on:{"update:visible":function(e){t.recommendVisible=e}}},[s("div",[s("el-select",{attrs:{placeholder:"请选择推荐版块"},model:{value:t.moduleId,callback:function(e){t.moduleId=e},expression:"moduleId"}},t._l(t.moduleList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.title,value:t.module_id}})})),1)],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.recommend}},[t._v("确 定")])],1)]):t._e(),t._v(" "),t.postModalVisible?s("PostModal",{attrs:{visible:t.postModalVisible,"if-update":!0,"post-id":t.postId},on:{"update:visible":function(e){t.postModalVisible=e}}}):t._e(),t._v(" "),t.reportModalVisible?s("ReportModal",{attrs:{visible:t.reportModalVisible,"source-id":t.postId},on:{"update:visible":function(e){t.reportModalVisible=e}}}):t._e(),t._v(" "),t.tagModalVisible?s("TagModal",{attrs:{visible:t.tagModalVisible,"need-module":!0},on:{"update:visible":function(e){t.tagModalVisible=e},back:t.addToFeed}}):t._e()],1)}),[],!1,null,"42fcab3e",null);e.default=c.exports;installComponents(c,{PostModal:s(729).default,ReportModal:s(748).default,TagModal:s(718).default})},881:function(t,e,s){"use strict";s(795)},882:function(t,e,s){"use strict";s(796)},883:function(t,e,s){"use strict";s(797)},884:function(t,e,s){"use strict";s(798)},894:function(t,e,s){"use strict";s(807)},896:function(t,e,s){"use strict";s(808)},897:function(t,e,s){"use strict";s(809)},898:function(t,e,s){"use strict";s(810)},899:function(t,e,s){"use strict";s(811)},900:function(t,e,s){"use strict";s(812)},901:function(t,e,s){"use strict";s(813)},902:function(t,e,s){"use strict";s(814)},903:function(t,e,s){"use strict";s(815)},916:function(t,e,s){"use strict";s.r(e);s(158),s(73),s(43),s(14),s(39),s(40),s(50),s(57);function i(t,e){var s;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,c=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return r=t.done,t},e:function(t){c=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(c)throw n}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var o={name:"Lor",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{hero:function(){var t=[];if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);if(!e.heroImg)return t;var s,a=i(e.heroImg);try{for(a.s();!(s=a.n()).done;){var o=s.value.split("@");t.push({num:o[0],img:o[1]})}}catch(t){a.e(t)}finally{a.f()}return t},region:function(){var t=[];if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);return e.regionIcon?e.regionIcon.split(","):t}},created:function(){},mounted:function(){},methods:{}},n=(s(896),s(20)),r=Object(n.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dk lor"},[s("ul",{staticClass:"hero-list"},t._l(t.hero,(function(e,i){return s("li",{key:i,staticClass:"hero-item"},[s("img",{attrs:{src:e.img,alt:""}}),t._v(" "),s("span",[t._v(t._s(e.num))])])})),0),t._v(" "),t._m(0),t._v(" "),s("ul",{staticClass:"region-icons"},t._l(t.region,(function(t,e){return s("li",{key:e,staticClass:"region-icon"},[s("img",{attrs:{src:t,alt:""}})])})),0)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dk-info"},[e("span",[this._v("卡特盖伦")])])}],!1,null,"0c93c50a",null).exports,c={name:"Gwent",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{cardTotal:function(){var t=0;if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);for(var s in e)t+=e[s];return t},factionImg:function(){return"http://static.iyingdi.cn/yingdiWeb/images/tools/cards/gwent/faction/b/".concat(this.deckData.faction,".png")}},created:function(){},mounted:function(){},methods:{}},l=(s(897),Object(n.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dk gwent"},[s("h4",{staticClass:"dk-title"},[t._v(t._s(t.deckData.name))]),t._v(" "),s("div",{staticClass:"ability"},[s("span",[t._v("能力："+t._s(t.deckData.ability))]),t._v(" "),s("span",[t._v("招募费："+t._s(t.deckData.build))])]),t._v(" "),s("div",{staticClass:"card-num"},[t._v("牌数："+t._s(t.cardTotal))]),t._v(" "),s("img",{staticClass:"faction-icon",attrs:{src:t.factionImg,alt:""}})])}),[],!1,null,"f831f9e2",null).exports),d=(s(71),{name:"Hearthstone",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{rarity:function(){var t=[];if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);for(var s in e)t.push({text:s,value:e[s]});return t},faction:function(){var t=this.deckData.faction;return t?"https://static.iyingdi.cn/yingdiWeb/images/tools/decks/hearthstone/faction/back/".concat(t.charAt(0).toUpperCase()).concat(t.slice(1),".png"):""}},created:function(){},mounted:function(){},methods:{}}),p=(s(898),Object(n.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dk hearthstone",style:{backgroundImage:"url("+t.faction+")"}},[s("h4",{staticClass:"dk-title"},[t._v("["+t._s(t.deckData.format)+"] "+t._s(t.deckData.name))]),t._v(" "),s("p",{staticClass:"dk-build"},[t._v("粉尘："+t._s(t.deckData.build))]),t._v(" "),s("ul",{staticClass:"dk-rarity"},t._l(t.rarity,(function(e,i){return s("li",{key:i},[t._v(t._s(e.text)+"："+t._s(e.value))])})),0)])}),[],!1,null,"9d6e89ba",null).exports);s(72);function u(t,e){var s;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,r=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==s.return||s.return()}finally{if(r)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var v={name:"Magic",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{rarityMap:{mythicrare:"秘稀",rare:"稀有",uncommon:"非普通",common:"普通",special:"其他"}}},computed:{rarity:function(){var t=[];if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);for(var s in e)t.push({text:this.rarityMap[s.toLocaleLowerCase().replace(/\s*/g,"")],value:e[s]});return t},color:function(){var t=[];if(!this.deckData.color)return t;var e,s=u(this.deckData.color.split(""));try{for(s.s();!(e=s.n()).done;){var i=e.value;"A"!==i&&t.push("http://static.iyingdi.cn/yingdiWeb/images/tools/cards/magic/color/".concat(i,".png"))}}catch(t){s.e(t)}finally{s.f()}return t}},created:function(){},mounted:function(){},methods:{}},m=(s(899),Object(n.a)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dk magic"},[s("h4",{staticClass:"dk-title"},[t._v(t._s(t.deckData.name))]),t._v(" "),s("ul",{staticClass:"dk-rarity"},t._l(t.rarity,(function(e,i){return s("li",{key:i},[t._v(t._s(e.text)+"："+t._s(e.value))])})),0),t._v(" "),s("div",{staticClass:"color"},t._l(t.color,(function(t,e){return s("img",{key:e,attrs:{src:t,alt:""}})})),0)])}),[],!1,null,"188fabbb",null).exports),h={name:"Verse",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{rarityMap:{bronze:"铜卡",silver:"银卡",gold:"金卡",legendary:"虹卡"}}},computed:{rarity:function(){var t=[];if(!this.deckData.rarityInfo)return t;var e=JSON.parse(this.deckData.rarityInfo);for(var s in e)t.push({text:this.rarityMap[s.toLocaleLowerCase()],value:e[s]});return t},faction:function(){var t=this.deckData.faction;return t?"https://static.iyingdi.cn/yingdiWeb/images/tools/decks/verse/faction/back/".concat(t,".jpg"):""}},created:function(){},mounted:function(){},methods:{}},g=(s(900),Object(n.a)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dk verse",style:{backgroundImage:"url("+t.faction+")"}},[s("h4",{staticClass:"dk-title"},[t._v(t._s(t.deckData.name))]),t._v(" "),s("p",{staticClass:"dk-build"},[t._v("打造："+t._s(t.deckData.build))]),t._v(" "),s("ul",{staticClass:"dk-rarity"},t._l(t.rarity,(function(e,i){return s("li",{key:i},[t._v(t._s(e.text)+"："+t._s(e.value))])})),0)])}),[],!1,null,"e3361f2e",null).exports),_={name:"Hundred",components:{},props:{deckData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{pertain:function(){return this.deckData.rarityInfo?this.deckData.rarityInfo.split(","):[]}},created:function(){},mounted:function(){},methods:{}},b=(s(901),{name:"Deck",components:{lor:r,gwent:l,hearthstone:p,magic:m,verse:g,hundred:Object(n.a)(_,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dk hundred"},[e("h4",{staticClass:"dk-title"},[this._v(this._s(this.deckData.name))]),this._v(" "),e("div",{staticClass:"pertain-icons"},this._l(this.pertain,(function(t,s){return e("div",{key:s,staticClass:"pertain-item"},[e("img",{attrs:{src:t,alt:""}})])})),0)])}),[],!1,null,"694f7b58",null).exports},props:{deck:{type:String,default:function(){return""}}},data:function(){return{deckLink:""}},computed:{formatDeck:function(){return this.$utils.checkIsJSON(this.deck)?JSON.parse(this.deck):{}}},created:function(){},mounted:function(){this.deckLink=this.getDeckLink()},methods:{getDeckLink:function(){var t="";switch(this.formatDeck.deckType){case"hearthstone":t="/web/tools/hearthstone/userdecks/deckdetail/".concat(this.formatDeck.id);break;case"magic":t="/web/tools/mtg/userdecks/deckdetail/".concat(this.formatDeck.id);break;case"gwent":t="/web/tools/gwent/userdecks/deckdetail/".concat(this.formatDeck.id);break;case"verse":t="/web/tools/verse/userdecks/deckdetail/".concat(this.formatDeck.id);break;case"hundred":t="/web/tools/baiwen/userDecks/deckdetail/".concat(this.formatDeck.id);break;case"lor":t="/web/tools/lor/userdecks/deckdetail/".concat(this.formatDeck.id)}return t}}}),y=(s(902),Object(n.a)(b,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"deck-item"},[e("a",{attrs:{href:this.deckLink,target:"_blank"}},[e(this.formatDeck.deckType,{tag:"component",attrs:{"deck-data":this.formatDeck}})],1)])}),[],!1,null,null,null));e.default=y.exports},917:function(t,e,s){"use strict";s.r(e);s(71),s(94),s(93),s(123);var i=s(31),a=s(1),o=(s(794),s(75),s(157),s(49),s(391),s(39),s(57),{name:"Ballot",components:{},props:{},data:function(){return{token:this.$options.token,loginUrl:this.$options.routePre+"/login",ballotId:this.$options.ballotId,postId:this.$options.postId,ballotsList:this.$options.ballotsList,authorId:this.$options.authorId,user:this.$options.user,api:this.$options.api,ballotInfo:{},ballot:{},ballotOpt:[],ifbet:0,ifPic:0,ifMulti:0,ifOverdue:!1,ifSettled:!1,ifself:!1,ifbetted:!1,userTotal:0,chosedOptList:[],betVisible:!1,betOptId:"",betFire:0,rulesVisible:!1,rulesHtml:"",rankVisible:!1,rankList:[]}},computed:{},created:function(){},mounted:function(){this.getData()},methods:{getData:function(){var t=this,e=this.ballotsList.find((function(e){return e.ballot_id===t.ballotId}))||{};this.ballotInfo=e,this.ballotOpt=e.option_data||[],this.ifbetted=""!==e.user_option_ids,this.chosedOptList=e.user_option_ids&&""!==e.user_option_ids?e.user_option_ids.split("`").map(Number):[],this.parseTypeeData(e.type);var s=0;e.option_data.map((function(t){s+=t.user_number})),this.userTotal=s,this.ifself=this.authorId===this.user.id||!1,this.ifOverdue=(new Date).getTime()>1e3*e.end_time,this.ifSettled=2===e.state},chooseOpt:function(t){if(!this.ifOverdue&&!this.ifbetted&&!this.ifSettled)if(this.ifMulti)if(this.chosedOptList.includes(t.option_id)){var e=this.chosedOptList.indexOf(t.option_id);this.chosedOptList.splice(e,1)}else this.chosedOptList.push(t.option_id);else 0===this.chosedOptList.length?this.chosedOptList.push(t.option_id):this.$set(this.chosedOptList,0,t.option_id)},vote:function(t){var e=this;if(this.ifOverdue)return this.$message.warning("活动已到截止时间"),!1;if(this.ifbetted)return this.$message.warning("您已参与过活动"),!1;if(this.ifSettled)return this.$message.warning("活动已结束"),!1;if(this.ballotOpt.length>2&&0===this.chosedOptList.length)return this.$message.warning("请选择要投票的选项"),!1;if(this.ifbet)this.betOptId=t||this.chosedOptList[0],this.betVisible=!0;else{var s={post_id:this.postId,ballot_id:this.ballotId};t&&void 0!==t||(t=this.chosedOptList[0]),this.ifMulti?s.option_ids=this.chosedOptList.join("`"):s.option_ids=t,this.api.post.postBallot(s).then((function(t){e.$message.success("投票成功"),e.refreshBallot()})).catch((function(t){var s=t.response.data.retMsg&&void 0!==t.response.data.retMsg?t.response.data.retMsg:null;e.$message.error(s||"投票失败")}))}},confirmBetVote:function(){var t=this;if(0===this.betFire)return this.$message.warning("请选择下注营火数"),!1;var e={post_id:this.postId,ballot_id:this.ballotId,fire:this.betFire,option_ids:this.betOptId};this.api.post.postBallot(e).then((function(e){t.betVisible=!1,t.betFire=0,t.$message.success("下注成功"),t.refreshBallot()})).catch((function(e){var s=e.response.data.retMsg&&void 0!==e.response.data.retMsg?e.response.data.retMsg:null;t.$message.error(s||"下注失败")}))},settle:function(t){var e=this;this.ifOverdue?confirm("确定要将此设为正确选项并开奖么？")&&this.api.post.postBallotSetOpt({post_id:this.postId,ballot_id:this.ballotId,option_id:t}).then((function(t){e.$message.success("设置成功，等待结算")})).catch((function(t){var s=t.response.data.retMsg&&void 0!==t.response.data.retMsg?t.response.data.retMsg:null;e.$message.error(s||"设置失败")})):this.$message.warning("尚未到截止时间")},refreshBallot:function(){var t=this;this.api.post.getBallotInfo({post_id:this.postId}).then((function(e){t.ballotsList=e.data||[],t.getData()}))},checkRank:function(){var t=this;this.ifSettled?this.api.post.getBallotRank({post_id:this.postId,ballot_id:this.ballotId}).then((function(e){t.rankList=e.data,t.rankVisible=!0})):this.$message.warning("还未开奖, 请耐心等待开奖")},checkRules:function(){this.rulesHtml='\n        <div class="rules-content">\n          <div class="para-item">\n          <p class="para-title">活动说明</p>\n          <p class="text-content">营地竞猜/投票功能是一个使用旅法师营地积分（即“营火”）来参与的活动（以下称“本次活动”），本次活动覆盖电子竞技，体育赛事，娱乐热点等诸多用户自发创建的内容。您可以使用营火进行投票竞猜，猜对将赢得营火，也可以主动创建一个竞猜或投票功能。</p>\n          </div>\n          <div class="para-item">\n            <p class="para-title">参与方式</p>\n            <p class="text-content">本次活动可由任意带有相关功能的社区文章进入，您可以选择您感兴趣的活动，花费一定营火参与竞猜。活动结束公布答案时，猜对的一方将返还你投的营火数并获得输掉一方营火作为奖励,猜错的一方则不返还营火。建议收藏此文章，以便查看比赛结果。(注:获胜奖励=你下注的营火数 ÷ 你支持阵营的总营火数 x 对方阵营总营火数 x 系数)请您注意，营火池、营火收益等我们提供的竞猜相关数据仅为供您在自主酌定下注数量时借以参考，我们并不对其准确性、可适用性等做出任何保证。如您猜中，您最终获得的营火结算，以营地统计的数字为准。</p>\n          </div>\n          <div class="para-item">\n            <p class="para-title">如何获得营火</p>\n            <p class="text-content">在旅法师营地完成每日任务；参与其他竞猜；邀请新用户；参与营地活动；购买营地月卡等方式均可获得营火奖励。</p>\n          </div>\n          <div class="para-item">\n            <p class="para-title">如何知道结果</p>\n            <p class="text-content">每场竞猜的竞猜结果都会在该竞猜内展示，结果公布后相应竞猜的奖励会自动发放到您的账户，营火的明细详见【我的-营火】页面。</p>\n          </div>\n          <div class="para-item">\n            <p class="para-title">营火怎么花</p>\n            <p class="text-content">营地商城中会有部分营火兑换商品，可以在商城页面进行兑换。</p>\n          </div>\n          <div class="para-item">\n            <p class="para-title">其他声明</p>\n            <p class="text-content">1.声明</p>\n            <p class="text-content">（1）本功能完全无需用户消费人民币参与竞猜；严厉禁止和打击恶意刷参与活动的行为（包括但不限于多个账号参与本次活动进行刷奖的行为）；对于违反规定者，旅法师营地有权取消其奖励资格。</p>\n            <p class="text-content">（2）本功能相关内容为用户自发举办，营地并不对其准确性、可适用性等做出任何保证。</p>\n            <p class="text-content">2.法律条款</p>\n            <p class="text-content">“营地地竞猜/投票功能” （以下称“本功能”）为旅法师营地（以下称“营地”）的平台活动。您在参与本次活动之前，应请认真阅读并充分理解本次活动的活动规则、下注规则、奖励规则及法律条款（以下合称为“活动规则及相关条款”）。如您参与本次活动，则应视为您已完整阅读、充分理解并同意活动规则及相关条款。如您对活动规则及相关条款的任何部分存有异议，或者无法准确理解，请不要参与本次活动。</p>\n            <p class="text-content">本功能的相关规则及相关条款由营地设定，营地亦可在本功能动进行期间，根据本次活动的实际情况，自主地对规则及相关条款进行变动或调整，并公布于本功能的相应页面。规则及相关条款更新后，将于公布之时起生效，如您不同意接受该等更新，应请停止参与本次活动</p>\n            <p class="text-content">（1）为本功能的公平性，您不应以任何作弊的或其他不正当的行为（包括但不限于恶意刷等任何的技术或人工手段）参与本功能，不应利用系统漏洞来获得不正当的非法利益。营地不承认上述不正当行为和利益的效力；如经发现，营地将有权取消其参与本功能的资格和其因参与本功能而获得的全部奖励（包括但不限于收回其因参与本功能而获得的营火、获得/兑换的奖品和/或其他奖励，以下同）。若因此造成损失，营地不会做出任何补偿或赔偿。</p>\n            <p class="text-content">（2）您参与本功能的所有行为，包括但不限于您发布、传播的跟帖评论等内容，应符合法律法规、相关政策及相关平台规范，无任何不良、非法或侵权内容，无任何广告或推广信息（营地及其关联公司的产品或服务除外）。否则，如经发现，营地将有权取消其参与本次活动的资格并收回其因参与本次活动而获得的全部奖励，同时依照相关平台规则进行处罚。若因此造成损失，营地不会做出任何补偿或赔偿。</p>\n            <p class="text-content">（3）请您了解，营地并不保证本功能不会出现中断，若因此造成损失，营地不承担责任。同时，为营地和/或本功能的运营需要，营地有权依照自主决定随时修改、暂停或终止本功能及相关服务，而无需为此做出任何补偿、赔偿或承担任何责任。</p>\n            <p class="text-content">（4）如您在参与本功能期间，因个人操作不当，或者电信运营商故障、计算机病毒或黑客攻击、技术问题、网络或电脑故障、系统不稳定性、政府管制、法律或政策变动以及其他各种第三方或不可抗力原因，无法参与本功能或遭受任何损失，营地不承担责任。</p>\n            <p class="text-content">（5）如您因参与本功能，依照相关活动规则获得任何营火，营火的具体数量将以营地统计的数字为准。</p>\n            <p class="text-content">（6）请您了解，营地并不保证在本功能中提供的任何信息或内容（包括但不限于营火收益等本次活动相关数据）的真实性与准确性，如您需利用在本功能中获知的信息或内容进行任何其他行为，应请自行对相关信息或内容进行核实后使用，并对使用后果自行负责。</p>\n            <p class="text-content">（7）请您了解，本功能的相关信息（包括但不限于奖品信息等）仅于旅法师营地平台发布，营地并未委托任何第三方机构或个人通知用户中奖或进行其他本次活动相关行为，如有任何人冒用营地名义进行上述行为，请您予以警惕、切勿轻信，否则因此造成损失的，营地不承担责任。</p>\n            <p class="text-content">（8）任何人不应利用本功能进行博彩类行为，如经发现，营地将有权取消其使用、参与本功能的资格和其因参与本功能而获得的全部奖励；如已构成犯罪，营地有权移交司法机关处理，因此给营地造成损失的，应承担赔偿责任。</p>\n          </div>\n        </div>\n      ',this.rulesVisible=!0},parseTypeeData:function(t){this.ifbet=parseInt(t[0]),this.ifMulti=parseInt(t[1]),this.ifPic=parseInt(t[2])},changeToPercent:function(t,e){if(t.user_number>0){if(e===this.ballotOpt.length-1){for(var s=0,i=0;i<this.ballotOpt.length-1;i++)s+=Math.round(100*this.ballotOpt[i].user_number/this.userTotal);return"".concat(100-s,"%")}var a=Math.round(100*t.user_number/this.userTotal);return"".concat(a,"%")}return"0%"}}}),n=(s(881),s(20)),r=Object(n.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{key:t.ballotId,staticClass:"post-rich-ballot"},[s("div",{staticClass:"title"},[t._v(t._s(t.ballotInfo.title))]),t._v(" "),s("div",{staticClass:"end-time"},[t._v("有效期截止至："+t._s(t._f("parseTime")(t.ballotInfo.end_time)))]),t._v(" "),s("hr",{attrs:{size:"1"}}),t._v(" "),2===t.ballotOpt.length?s("div",{staticClass:"two-opt-style"},[t.ifPic?s("div",{staticClass:"two-pic-row"},[s("img",{staticClass:"left-img",attrs:{src:t.ballotOpt[0].img}}),t._v(" "),s("img",{staticClass:"right-img",attrs:{src:t.ballotOpt[1].img}})]):s("div",{staticClass:"two-title-row"},[s("div",{staticClass:"left-title"},[(t.ifOverdue||t.ifbetted)&&t.ballotOpt[0].correct?s("SvgIcon",{attrs:{"icon-class":"ballotcorrectopt","class-name":"text-green-correct"}}):t._e(),t._v("\n        "+t._s(t.ballotOpt[0].title)+"\n      ")],1),t._v(" "),s("div",{staticClass:"right-title"},[(t.ifOverdue||t.ifbetted)&&t.ballotOpt[1].correct?s("SvgIcon",{attrs:{"icon-class":"ballotcorrectopt","class-name":"text-green-correct"}}):t._e(),t._v(" "),s("span",[t._v(t._s(t.ballotOpt[1].title))])],1)]),t._v(" "),t.ifOverdue||t.ifbet||t.ifbetted?s("div",[s("div",{staticClass:"two-vote-row"},[s("div",[t._v(t._s(t.ballotOpt[0].user_number)+"人支持"),t.ifbet?s("span",{staticStyle:{"margin-left":"10px"}},[t._v("营火:"+t._s(t.ballotOpt[0].fire_number))]):t._e()]),t._v(" "),s("div",[t._v(t._s(t.ballotOpt[1].user_number)+"人支持"),t.ifbet?s("span",{staticStyle:{"margin-left":"10px"}},[t._v("营火:"+t._s(t.ballotOpt[1].fire_number))]):t._e()])]),t._v(" "),s("div",{staticClass:"color-bar-row"},[s("div",{staticClass:"left-bar",style:{width:t.changeToPercent(t.ballotOpt[0],0)}},[s("div",{staticClass:"progress"})]),t._v(" "),s("div",{staticClass:"right-bar",style:{width:t.changeToPercent(t.ballotOpt[1],1)}},[s("div",{staticClass:"progress"})])]),t._v(" "),s("div",{staticClass:"two-vote-row"},[s("div",[t._v(t._s(t.changeToPercent(t.ballotOpt[0],0)))]),t._v(" "),s("div",[t._v(t._s(t.changeToPercent(t.ballotOpt[1],1)))])])]):t._e(),t._v(" "),t.token&&""!==t.token?s("div",{staticClass:"two-operate-row"},[t.ifbetted&&t.chosedOptList.includes(t.ballotOpt[0].option_id)?s("a",{staticClass:"vote-btn left voted"},[t._v("已投票")]):s("a",{staticClass:"vote-btn left",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.vote(t.ballotOpt[0].option_id)}}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")]),t._v(" "),t.ifbetted&&t.chosedOptList.includes(t.ballotOpt[1].option_id)?s("a",{staticClass:"vote-btn right voted"},[t._v("已投票")]):s("a",{staticClass:"vote-btn right",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.vote(t.ballotOpt[1].option_id)}}},[t._v("投票")])]):s("div",{staticClass:"two-operate-row"},[s("a",{staticClass:"vote-btn left",attrs:{href:t.loginUrl}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")]),t._v(" "),s("a",{staticClass:"vote-btn right",attrs:{href:t.loginUrl}},[t._v("投票")])]),t._v(" "),t.ifbet&&t.ifself&&!t.ifSettled?s("div",{staticClass:"two-settle-row"},[s("a",{staticClass:"settle-left cursor-pointer",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.settle(t.ballotOpt[0].option_id)}}},[t._v("设为正确选项")]),t._v(" "),s("a",{staticClass:"settle-right cursor-pointer",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.settle(t.ballotOpt[1].option_id)}}},[t._v("设为正确选项")])]):t._e()]):t.ballotOpt.length>2?s("div",{staticClass:"multi-opt-style"},[t.ifPic?s("div",{staticClass:"has-pic-style"},[t._l(t.ballotOpt,(function(e,i){return s("div",{key:""+e.option_id+i,staticClass:"opt-item",class:{correct:e.correct&&(t.ifOverdue||t.ifbetted||t.ifSettled)},attrs:{"data-optid":e.option_id},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.chooseOpt(e)}}},[s("div",{staticClass:"img-row"},[s("img",{attrs:{src:e.img}}),t._v(" "),s("div",{staticClass:"vote-opt-btn",class:{checked:t.chosedOptList.includes(e.option_id)}})]),t._v(" "),t.ifOverdue||t.ifbet||t.ifbetted?s("div",{staticClass:"color-bar-row"},[s("div",{staticClass:"bar",style:{width:t.changeToPercent(e,i)}},[s("div",{staticClass:"progress"})])]):t._e(),t._v(" "),s("div",{staticClass:"title-row"},[t._v(t._s(e.title))]),t._v(" "),t.ifOverdue||t.ifbet||t.ifbetted?s("div",{staticClass:"footer-row"},[s("span",[t._v(t._s(e.user_number)+"人支持")]),t._v(" "),t.ifbet?s("span",[t._v("营火:"+t._s(e.fire_number))]):t._e(),t._v(" "),s("span",{staticClass:"percent"},[t._v(t._s(t.changeToPercent(e,i)))]),t._v(" "),e.correct&&(t.ifOverdue||t.ifbetted)?s("div",{staticClass:"correct-opt"},[s("SvgIcon",{attrs:{"icon-class":"ballotcorrectopt","class-name":"text-green-correct"}})],1):t._e()]):t._e(),t._v(" "),t.ifbet&&t.ifself&&!t.ifSettled?s("div",{staticClass:"settle-row"},[s("a",{staticClass:"settle-btn",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.settle(e.option_id)}}},[t._v("设为正确选项")])]):t._e()])})),t._v(" "),t.token&&""!==t.token?s("div",{staticClass:"operate-row"},[t.ifbetted?s("a",{staticClass:"vote-btn"},[t._v("已投票")]):!t.ifbet||t.ifOverdue||t.ifSettled?s("a",{staticClass:"vote-btn",on:{click:function(e){return t.vote()}}},[t._v("投票")]):s("a",{staticClass:"vote-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.vote()}}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")])]):s("div",{staticClass:"operate-row"},[s("a",{staticClass:"vote-btn",attrs:{href:t.loginUrl}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")])])],2):s("div",{staticClass:"no-pic-style"},[t._l(t.ballotOpt,(function(e,i){return s("div",{key:""+e.option_id+i,staticClass:"opt-item",class:{correct:e.correct&&(t.ifOverdue||t.ifbetted||t.ifSettled)},attrs:{"data-optid":e.option_id},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.chooseOpt(e)}}},[s("div",{staticClass:"ballot-info"},[s("div",{staticClass:"opt-title"},[t._v(t._s(e.title))]),t._v(" "),t.ifOverdue||t.ifbet||t.ifbetted?s("div",{staticClass:"color-bar-row"},[s("div",{staticClass:"bar",style:{width:t.changeToPercent(e,i)}},[s("div",{staticClass:"progress"})])]):t._e(),t._v(" "),t.ifOverdue||t.ifbet||t.ifbetted?s("div",{staticClass:"opt-detail-info"},[t.ifbet?s("span",[t._v("营火:"+t._s(e.fire_number))]):t._e(),t._v(" "),s("span",[t._v(t._s(e.user_number)+"人支持")]),t._v(" "),s("span",{staticClass:"percent"},[t._v(t._s(t.changeToPercent(e,i)))])]):t._e()]),t._v(" "),t.ifbet&&t.ifself&&!t.ifSettled?s("a",{staticClass:"settle-btn",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.settle(e.option_id)}}},[t._v("设为正确选项")]):t._e(),t._v(" "),(t.ifOverdue||t.ifbetted)&&e.correct?s("div",{staticClass:"correct-opt"},[s("SvgIcon",{attrs:{"icon-class":"ballotcorrectopt","class-name":"text-green-correct"}})],1):t._e(),t._v(" "),s("div",{staticClass:"vote-opt-btn",class:{checked:t.chosedOptList.includes(e.option_id)}})])})),t._v(" "),t.token&&""!==t.token?s("div",{staticClass:"operate-row"},[t.ifbetted?s("a",{staticClass:"vote-btn"},[t._v("已投票")]):!t.ifbet||t.ifOverdue||t.ifSettled?s("a",{staticClass:"vote-btn",on:{click:function(e){return t.vote()}}},[t._v("投票")]):s("a",{staticClass:"vote-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.vote()}}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")])]):s("div",{staticClass:"operate-row"},[s("a",{staticClass:"vote-btn",attrs:{href:t.loginUrl}},[t._v("投票")]),t._v(" "),s("a",{staticClass:"vote-rules",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRules(e)}}},[t._v("点击查看规则")])])],2)]):t._e(),t._v(" "),t.ifbet?s("div",{staticClass:"rank-list-row"},[s("a",{staticClass:"rank-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.checkRank(e)}}},[t._v("竞猜排行榜")])]):t._e(),t._v(" "),s("el-dialog",{attrs:{visible:t.rulesVisible,"lock-scroll":!1,title:"投票竞猜规则"},on:{"update:visible":function(e){t.rulesVisible=e}}},[s("div",{domProps:{innerHTML:t._s(t.rulesHtml)}})]),t._v(" "),s("el-dialog",{attrs:{visible:t.rankVisible,"lock-scroll":!1,title:"竞猜排行榜"},on:{"update:visible":function(e){t.rankVisible=e}}},[s("div",{staticClass:"mx-auto"},[s("ul",{staticClass:"space-y-10"},[s("li",{staticClass:"grid grid-cols-3 text-center"},[s("span",[t._v("排名")]),t._v(" "),s("span",[t._v("玩家")]),t._v(" "),s("span",[t._v("营火")])]),t._v(" "),t._l(t.rankList,(function(e,i){return s("li",{key:i,staticClass:"grid grid-cols-3 text-center"},[s("span",{staticClass:"rank-no"},[t._v(t._s(i+1))]),t._v(" "),s("span",{staticClass:"user-name"},[t._v(t._s(e.username))]),t._v(" "),s("span",{staticClass:"last-span"},[t._v(t._s(e.reward_fire))])])}))],2),t._v(" "),0===t.rankList.length?s("div",{staticClass:"text-center text-sm text-gray-250 m-30"},[t._v("暂无排名数据")]):t._e()])]),t._v(" "),s("el-dialog",{attrs:{visible:t.betVisible,"lock-scroll":!1,title:"选择下注"},on:{"update:visible":function(e){t.betVisible=e}}},[s("div",{staticClass:"mx-auto"},[s("div",{staticClass:"choose-bet-amount grid grid-cols-3 gap-5 text-center"},[s("div",{class:{checked:10===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=10}}},[t._v("10营火")]),t._v(" "),s("div",{class:{checked:50===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=50}}},[t._v("50营火")]),t._v(" "),s("div",{class:{checked:100===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=100}}},[t._v("100营火")]),t._v(" "),s("div",{class:{checked:200===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=200}}},[t._v("200营火")]),t._v(" "),s("div",{class:{checked:500===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=500}}},[t._v("500营火")]),t._v(" "),s("div",{class:{checked:1e3===t.betFire},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.betFire=1e3}}},[t._v("1000营火")])])]),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.confirmBetVote}},[t._v("确定下注")])],1)])],1)}),[],!1,null,"1ed1c477",null),c=r.exports;installComponents(r,{SvgIcon:s(74).default});var l=s(36);function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){Object(i.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var u={name:"PostRichDetail",props:{postInfo:{type:Object,default:function(){return{}}}},data:function(){return{postType:{oldRich:[12,21],newRich:13},ballotsList:[],card:{},operateBoxVisible:!1}},computed:{token:function(){return this.$store.getters.token},author:function(){return this.postInfo.author||{}},post:function(){var t=this.postInfo.post;return this.$utils.checkIsJSON(t.tag_json)&&(t.tagList=JSON.parse(t.tag_json)),this.postType.oldRich.includes(t.type)&&(t.oldContent=this.$utils.checkIsJSON(t.content)?JSON.parse(t.content):[]),t.newContent=this.postInfo.post.content,t}},mounted:function(){var t=this;this.postInfo.post.type===this.postType.newRich&&this.$nextTick((function(){t.handleContentHtmlAfterRender()}))},methods:p(p({},Object(l.c)("gameCard",{setVisible:"setVisible"})),{},{handleRichClick:function(t){var e=this.closest(t.target,".yingdi-card"),s=this.closest(t.target,".yingdi-deck"),i=this.closest(t.target,".yingdi-audio"),a=!!/yingdi-image gif/.test(t.target.className)&&t.target,o=!!/yingdi-image/.test(t.target.className)&&t.target,n=!!/scanningCard/.test(t.target.className)&&t.target;e?this.handleCardClick(t,e):s?this.handleDeckClick(t,s):i?this.handleAudioClick(t,i):a?this.handleGifImgClick(t,a):o?this.handleImgClick(t,o):n&&this.handleScanningCardClick(t,n)},handleCardClick:function(t,e){switch(e.className){case"yingdi-card article":var s=Number(e.getAttribute("data-id"));this.$router.push("".concat(this.$settings.routePre,"/post/").concat(s+3e6));break;case"yingdi-card bbspost":var i=e.getAttribute("data-id");this.$router.push("".concat(this.$settings.routePre,"/post/").concat(i));break;case"yingdi-card user":var a=e.getAttribute("data-id");this.$router.push("".concat(this.$settings.routePre,"/people/").concat(a));break;case"yingdi-card commodity":var o=e.getAttribute("data-id");this.$utils.linkJump("".concat("https://www.iyingdi.com","/web/shop/shopdet?com=").concat(o));break;case"yingdi-card deck-set":var n=e.getAttribute("data-game"),r=e.getAttribute("data-id"),c="";switch(n){case"hundred":c="".concat("https://www.iyingdi.com","/web/tools/baiwen/deckset/setdetail?btypes=home_allset&setid=").concat(r);break;case"magic":c="".concat("https://www.iyingdi.com","/web/tools/mtg/decks/setdetail?btypes=home_allset&setid=").concat(r);break;default:c="".concat("https://www.iyingdi.com","/web/tools/").concat(n,"/decks/setdetail?btypes=home_allset&setid=").concat(r)}this.$utils.linkJump(c)}},handleDeckClick:function(t,e){if("copy-code"===t.target.className){var s=e.getElementsByTagName("aside")[0],i=window.getSelection(),a=document.createRange();a.selectNodeContents(s),i.removeAllRanges(),i.addRange(a),document.execCommand("copy"),this.$message({type:"success",message:"已成功复制到剪贴板",offset:300})}else if("deck-link"===t.target.className){var o=t.target.getAttribute("data-game"),n=t.target.getAttribute("data-id"),r="";switch(o){case"hundred":r="".concat("https://www.iyingdi.com","/web/tools/baiwen/userdecks/deckdetail/").concat(n);break;case"magic":r="".concat("https://www.iyingdi.com","/web/tools/mtg/userdecks/deckdetail/").concat(n);break;default:r="".concat("https://www.iyingdi.com","/web/tools/").concat(o,"/userdecks/deckdetail/").concat(n)}this.$utils.linkJump(r)}},handleScanningCardClick:function(t,e){var s=e.getAttribute("data-gametype"),i=e.getAttribute("data-cardid"),a=e.getAttribute("data-cardimg");this.openCard(s,i,a)},handleAudioClick:function(t,e){var s=e.querySelector(".audio-cover"),i=e.querySelector(".audio-area"),a=e.querySelector("audio");a.setAttribute("autoplay","autoplay"),e.removeChild(s),i.className="audio-area",a.play()},handleGifImgClick:function(t,e){var s=e.getAttribute("data-original");e.setAttribute("src",s),e.className="yingdi-image"},handleImgClick:function(t,e){},handleContentHtmlBeforeRender:function(t){return'<div v-lazy-container="{ selector: \'.yingdi-image\'}" class="edit-preview">'.concat(t,"</div>")},handleContentHtmlAfterRender:function(){this.handleBallotRender(),this.handleCardIdentify()},handleBallotRender:function(){var t=this,e=document.querySelectorAll(".yingdi-ballot");e.length>0&&this.$apiRepository.post.getBallotInfo({post_id:this.postInfo.post.id}).then((function(s){for(var i=s.data||[],o=0;o<e.length;o++){var n=e[o],r=parseInt(n.getAttribute("data-ballotid"));n.innerHTML="<div></div>";try{new(a.default.extend(c))({token:t.token,ballotId:r,postId:t.postInfo.post.id,ballotsList:i,authorId:t.postInfo.author.id,user:t.$store.getters.userInfo,routePre:t.$settings.routePre,api:t.$apiRepository}).$mount(n.firstChild)}catch(t){}}})).catch((function(t){}))},handleCardIdentify:function(){var t=document.querySelectorAll(".scanningCard");if(t.length>0)for(var e=0;e<t.length;e++){var s=t[e],i=s.getAttribute("href");s.setAttribute("data-cardimg",i),s.setAttribute("class","scanningCard cursor-pointer"),s.removeAttribute("href")}},openCard:function(t,e,s){this.card={id:e,game:t,imageSrc:s},this.setVisible(!0)},closest:function(t,e){var s=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;if(s)for(;t;){if(s.call(t,e))return t;t=t.parentElement}return null}})},f=(s(882),Object(n.a)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-rich-detail"},[s("div",{staticClass:"cover-area",style:{backgroundImage:"url("+t.post.cover+")"}}),t._v(" "),s("div",{staticClass:"header-area"},[s("div",[s("div",{staticClass:"post-title"},[t.post.rs_feed_created?s("i",{staticClass:"recommend"}):t._e(),t._v("\n        "+t._s(t.post.title)+"\n      ")]),t._v(" "),s("div",{staticClass:"post-detail-info"},[t.post.created?s("div",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(t.post.created)))]):t._e(),t._v(" "),s("div",{staticClass:"flex flex-row justify-end items-center"},[s("span",[t._v("点火")]),s("span",{staticClass:"align-middle ml-2"},[t._v(t._s(t.post.like_num))]),t._v(" "),s("span",{staticClass:"ml-30"},[t._v("回复")]),s("span",{staticClass:"align-middle ml-2"},[t._v(t._s(t.post.reply_num))])])])])]),t._v(" "),s("div",{staticClass:"post-main-content"},[s("div",{staticClass:"relative flex flex-row justify-between"},[s("div",{staticClass:"flex flex-row justify-start flex-wrap mb-20"},t._l(t.post.tagList,(function(t,e){return s("TagView",{key:e,staticClass:"mb-10 mr-10",attrs:{"tag-name":t.tag,"tag-id":t.id}})})),1),t._v(" "),t.$store.getters.token?s("div",{staticClass:"cursor-pointer",staticStyle:{color:"#787878"},on:{click:function(e){t.operateBoxVisible=!t.operateBoxVisible}}},[s("i",{staticClass:"el-icon-more"})]):t._e(),t._v(" "),t.operateBoxVisible?s("PostOperateBox",{staticClass:"absolute z-10 top-30",staticStyle:{right:"-60px"},attrs:{"post-id":t.post.id,"post-type":t.post.type,post:t.post,author:t.author}}):t._e()],1),t._v(" "),t.postType.oldRich.includes(t.post.type)?s("RichOldTemplate",{attrs:{content:t.post.oldContent}}):s("div",{staticClass:"rich-text-content",on:{click:function(e){return t.handleRichClick(e)}}},[s("div",{staticClass:"edit-preview",domProps:{innerHTML:t._s(t.post.newContent)}}),t._v(" "),s("card-detail",{attrs:{card:t.card}})],1)],1)])}),[],!1,null,"6b369977",null));e.default=f.exports;installComponents(f,{TagView:s(713).default,PostOperateBox:s(836).default,RichOldTemplate:s(937).default,CardDetail:s(915).default})},923:function(t,e,s){"use strict";s.r(e);s(158),s(49),s(73),s(43),s(14),s(39),s(40),s(50),s(57);function i(t,e){var s;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(s=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,c=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return r=t.done,t},e:function(t){c=!0,n=t},f:function(){try{r||null==s.return||s.return()}finally{if(c)throw n}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var o={name:"PostCommonDetail",props:{postInfo:{type:Object,default:function(){return{}}}},data:function(){return{postType:{video:14,pk:15,question:16,deck:17},operateBoxVisible:!1,previewImages:{list:[],options:{getThumbBoundsFn:function(t){var e=document.querySelectorAll(".img-item")[t],s=window.pageYOffset||document.documentElement.scrollTop,i=e.getBoundingClientRect();return{x:i.left,y:i.top+s,w:i.width}}}}}},computed:{author:function(){return this.postInfo.author||{}},post:function(){var t=this.postInfo.post||{};return this.$utils.checkIsJSON(t.tag_json)&&(t.tagList=JSON.parse(t.tag_json)),t.imgs&&""!==t.imgs&&(t.imgsList=t.imgs.split(/[;`]/)),t},user:function(){return this.postInfo.user},player:function(){return this.$refs.videoPlayer.player}},mounted:function(){this.setPreviewImage(),this.post.type===this.postType.video&&window.AnalysysAgent.track("post_detail_play_video",{post_id:"".concat(this.post.id),author_id:"".concat(this.author.id),tag_ids:JSON.parse(this.post.tag_json).map((function(t){return String(t.id)}))})},methods:{setPreviewImage:function(){if(!this.post.imgsList||!this.post.imgsList.length)return!1;var t=this;this.previewImages.list=[];var e,s=i(this.post.imgsList);try{var a=function(){var s=e.value,i=new Image;i.src=s,i.onload=function(){t.previewImages.list.push({msrc:s,src:s,w:i.width,h:i.height})}};for(s.s();!(e=s.n()).done;)a()}catch(t){s.e(t)}finally{s.f()}},previewImageShow:function(t){var e=0;this.previewImages.list.map((function(s,i){s.src===t&&(e=i)})),this.$refs.imagePreviewer.show(e)}}},n=(s(894),s(20)),r=Object(n.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-common-detail"},[t.post.type===t.postType.video?s("div",{staticClass:"video-area"},[s("client-only",[s("VideoShow",{attrs:{url:t.post.video_url,cover:t.post.cover}})],1)],1):t._e(),t._v(" "),s("div",{staticClass:"header-area"},[s("div",{staticClass:"post-title"},[t.post.rs_feed_created?s("i",{staticClass:"recommend"}):t._e(),t._v(" "),t.post.type===t.postType.question?s("i",{staticClass:"ask"}):t._e(),t._v(" "),s("span",[t._v(t._s(t.post.title))])]),t._v(" "),s("div",{staticClass:"post-detail-info"},[t.post.created?s("div",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(t.post.created)))]):t._e(),t._v(" "),s("div",{staticClass:"flex flex-row justify-end items-center"},[s("span",[t._v("点火")]),s("span",{staticClass:"align-middle ml-2"},[t._v(t._s(t.post.like_num))]),t._v(" "),s("span",{staticClass:"ml-30"},[t._v("回复")]),s("span",{staticClass:"align-middle ml-2"},[t._v(t._s(t.post.reply_num))])])])]),t._v(" "),s("div",{staticClass:"relative px-30 flex flex-row justify-between"},[s("div",{staticClass:"flex flex-row justify-start flex-wrap"},t._l(t.post.tagList,(function(t,e){return s("TagView",{key:e,staticClass:"mb-10 mr-10",attrs:{"tag-name":t.tag,"tag-id":t.id}})})),1),t._v(" "),t.$store.getters.token?s("div",{staticClass:"cursor-pointer",staticStyle:{color:"#787878"},on:{click:function(e){t.operateBoxVisible=!t.operateBoxVisible}}},[s("i",{staticClass:"el-icon-more"})]):t._e(),t._v(" "),t.operateBoxVisible?s("PostOperateBox",{staticClass:"absolute z-10 top-30",staticStyle:{right:"-20px"},attrs:{"post-id":t.post.id,post:t.post,"post-type":t.post.type,author:t.author}}):t._e()],1),t._v(" "),s("div",{staticClass:"px-30 mt-20 break-all",staticStyle:{"line-height":"1.7"},domProps:{innerHTML:t._s(t.post.content)}}),t._v(" "),t.post.imgs&&""!==t.post.imgs?s("ul",{staticClass:"pl-30 mt-20 grid grid-cols-3",staticStyle:{width:"500px"}},t._l(t.post.imgsList,(function(e,i){return s("li",{key:i,staticClass:"img-item pb-2",on:{click:function(s){return t.previewImageShow(e)}}},[s("div",{staticClass:"image-back",style:{backgroundImage:"url("+e+")"}})])})),0):t._e(),t._v(" "),t.post.type===t.postType.deck?s("div",{staticClass:"block px-30 mt-20"},[s("Deck",{attrs:{deck:t.post.deck_info_json}})],1):t._e(),t._v(" "),t.post.type===t.postType.pk?s("div",{staticClass:"px-30 mt-20"},[s("PkCommonTemplet",{attrs:{post:t.post,user:t.user,vote:t.post.vote_option_json},on:{"update:user":function(e){t.user=e}}})],1):t._e(),t._v(" "),s("client-only",[s("ImagePreviewer",{ref:"imagePreviewer",attrs:{list:t.previewImages.list,options:t.previewImages.options}})],1)],1)}),[],!1,null,"749a8c9d",null);e.default=r.exports;installComponents(r,{VideoShow:s(938).default,TagView:s(713).default,PostOperateBox:s(836).default,Deck:s(916).default,PkCommonTemplet:s(834).default})},924:function(t,e,s){"use strict";s.r(e);s(93);var i={name:"PostRewardRank",components:{},props:{visible:{type:Boolean,default:!1},postId:{type:[String,Number],default:""}},data:function(){return{url:"",rankList:[]}},computed:{},watch:{},created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.$apiRepository.post.getPostRewardRank({post_id:this.postId,page:1,size:50}).then((function(e){t.rankList=e.rank||[]})).catch((function(t){}))},close:function(){this.$emit("update:visible")}}},a=(s(903),s(20)),o=Object(a.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:t.visible,"lock-scroll":!1,title:"打赏排行",width:"600px","before-close":t.close},on:{"update:visible":function(e){t.visible=e}}},[s("div",{staticClass:"post-reward-rank-modal"},[s("el-scrollbar",{staticClass:"rank-list-scroll"},[t.rankList.length?s("ul",{staticClass:"divide-y divide-gray-EA px-10"},t._l(t.rankList,(function(e,i){return s("div",{key:i,staticClass:"flex flex-row justify-between items-center"},[s("UserTitle",{attrs:{user:e}}),t._v(" "),s("span",[t._v("打赏了"+t._s(e.amount)+"营火")])],1)})),0):s("div",{staticClass:"text-center text-base"},[t._v("暂无排行数据")])])],1)])}),[],!1,null,null,null);e.default=o.exports;installComponents(o,{UserTitle:s(733).default})},925:function(t,e,s){"use strict";s.r(e);var i={name:"PostDetailGoogleAd",components:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},a=s(20),o=Object(a.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"googleAd"},[e("adsbygoogle",{attrs:{"ad-slot":"5662595801","ad-format":"horizontal","data-full-width-responsive":"true"}})],1)}),[],!1,null,"f3b03d14",null);e.default=o.exports},937:function(t,e,s){"use strict";s.r(e);s(71),s(49);var i={name:"RichOldTemplate",components:{},props:{content:{type:Array,default:function(){return[]}}},data:function(){return{contentHtml:""}},computed:{},watch:{content:{deep:!0,handler:function(t,e){this.getHtml()}}},created:function(){},mounted:function(){this.getHtml()},methods:{getHtml:function(){var t=this,e="";this.content.map((function(s){e+=t.getBlockHtml(s)})),this.contentHtml=e},getBlockHtml:function(t){var e="";switch(t.type){case"text":e=this.getTextBlockHtml(t);break;case"image":e=this.getImageBlockHtml(t);break;case"video":e=this.getVideoBlockHtml(t);break;case"audio":e=this.getAudioBlockHtml(t);break;case"deckCode":e=this.getDeckBlockHtml(t);break;case"deckSet":e=this.getDeckSetBlockHtml(t);break;case"insertUser":e=this.getUserBlockHtml(t);break;case"goods":e=this.getGoodsBlockHtml(t)}return e},getTextBlockHtml:function(t){return'\n        <div class="article-textBlock">\n          '.concat(t.content,"\n        </div>\n      ")},getImageBlockHtml:function(t){var e=t.url;return/static\.iyingdi/.test(e)&&!/x-oss-process/.test(e)&&(e=/iyingdi_gif\.gif/.test(e)?"".concat(e,"?").concat("x-oss-process=image/resize,w_300,h_200,m_lfit"):"".concat(e,"?").concat("x-oss-process=image/resize,w_800,h_440,m_mfit/format,jpg/quality,Q_80")),'\n        <div class="article-imageFrame">\n          <img src="'.concat(e,'">\n        </div>\n      ')},getVideoBlockHtml:function(t){return'\n        <div class="article-mediaFrame">\n          <a href="'.concat(t.url,'">').concat(t.url,"</a>\n        </div>\n      ")},getAudioBlockHtml:function(t){return'\n        <div class="article-mediaFrame">\n          <a href="'.concat(t.src,'">').concat(t.src,"</a>\n        </div>\n      ")},getGoodsBlockHtml:function(t){return""},getDeckBlockHtml:function(t){return'\n        <div class="article-deckFrame">\n          <div class="article-deckFrame-deckImg">\n            <img src="'.concat(t.deckIcon,'">\n          </div>\n          ').concat(t.code&&""!==t.code?'\n            <div class="article-deckCode-content">\n              <div class="article-deckCodeArea">'.concat(t.code,"</div>\n            </div>\n          "):"","\n        </div>\n      ")},getDeckSetBlockHtml:function(t){var e="https://www.iyingdi.com/share/deckset/deckset.html?game=".concat(t.game,"&id=").concat(t.deckSetID);return'\n        <div class="article-deckSetFrame">\n          <a href="'.concat(e,'" target="_blank">').concat(e,"</a>\n        </div>\n      ")},getUserBlockHtml:function(t){return""}}},a=(s(884),s(20)),o=Object(a.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"rich-old-content"},[e("div",{domProps:{innerHTML:this._s(this.contentHtml)}})])}),[],!1,null,null,null);e.default=o.exports}}]);