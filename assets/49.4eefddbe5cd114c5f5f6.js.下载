(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{746:function(t,e,i){"use strict";i.r(e);i(391),i(39),i(72),i(57);var n={name:"CommentInput",props:{ifUpdate:{type:Boolean,default:!1},comment:{type:Object,default:function(){return{content:"",imgs:[]}}}},data:function(){return{limitImgNumber:3,imgsList:[],emojiModalVisible:!1,activeTabName:"0",commentData:{content:"",imgs:""}}},mounted:function(){this.renderData()},methods:{renderData:function(){this.ifUpdate&&(this.commentData.content=this.comment.content.replace(/<br>/g,"\n"),this.imgsList=Array.isArray(this.comment.imgs)?this.comment.imgs:this.comment.imgs?this.comment.imgs.split(/[;`]/):[])},addSuccess:function(t){if(this.imgsList.length===this.limitImgNumber)return!1;this.imgsList.push(t)},removeImg:function(t){this.imgsList.splice(t,1)},addEmoji:function(){if(!this.$store.getters.token)return this.$router.push("".concat(this.$settings.routePre,"/login")),!1;this.imgsList.length<this.limitImgNumber?this.emojiModalVisible=!this.emojiModalVisible:this.$message({type:"warning",message:"图片最多添加".concat(this.limitImgNumber,"张"),offset:300})},getCommentData:function(){return{content:this.$utils.filterHtmlTag(this.commentData.content).replace(/[\n\r]/g,"<br>"),imgs:this.imgsList.length>0?this.imgsList:[]}},confirm:function(){if(this.checkCommentData()){var t=this.getCommentData();this.ifUpdate?this.$emit("modify",{content:t.content,imgs:t.imgs}):this.$emit("send",{content:t.content,imgs:t.imgs}),this.imgsList=[],this.commentData={content:"",imgs:""}}},checkCommentData:function(){return this.$store.getters.token?""===this.commentData.content.replace(/[\s\n\r]/g,"")?(this.$message.warning("评论内容不能为空"),!1):!(this.imgsList.length>this.limitImgNumber)||(this.$message.warning("图片不能超过".concat(this.limitImgNumber,"张")),!1):(this.$router.replace("".concat(this.$settings.routePre,"/login")),!1)}}},a=(i(904),i(20)),s=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-input-component"},[i("div",{staticClass:"mb-10 space-x-2"},[i("FileUploadBtn",{attrs:{"btn-size":"mini",msg:"添加图片","if-disabled":t.imgsList.length>=t.limitImgNumber},on:{uploadSuccess:t.addSuccess}}),t._v(" "),i("el-button",{attrs:{size:"mini",icon:"el-icon-picture-outline",disabled:t.imgsList.length>=t.limitImgNumber},on:{click:t.addEmoji}},[t._v("添加表情")]),t._v(" "),i("EmojiModal",{attrs:{visible:t.emojiModalVisible},on:{"update:visible":function(e){t.emojiModalVisible=e},add:t.addSuccess}})],1),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"点击输入文本内容，图片最多添加"+t.limitImgNumber+"张"},model:{value:t.commentData.content,callback:function(e){t.$set(t.commentData,"content",e)},expression:"commentData.content"}}),t._v(" "),i("div",{staticClass:"flex flex-row justify-between items-center"},[i("div",{staticClass:"imgs-area"},t._l(t.imgsList,(function(e,n){return i("div",{key:n,staticClass:"img-item",style:{backgroundImage:"url("+e+")"}},[i("el-button",{staticClass:"img-delete-btn",attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.removeImg(n)}}})],1)})),0),t._v(" "),i("div",{staticClass:"mt-10 text-right"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.confirm(e)}}},[t._v(t._s(t.ifUpdate?"确认修改":"发表评论"))])],1)])],1)}),[],!1,null,"0e29347e",null);e.default=s.exports;installComponents(s,{FileUploadBtn:i(716).default,EmojiModal:i(717).default})},800:function(t,e,i){},801:function(t,e,i){},802:function(t,e,i){},803:function(t,e,i){},804:function(t,e,i){},805:function(t,e,i){},806:function(t,e,i){},816:function(t,e,i){},817:function(t,e,i){},818:function(t,e,i){},887:function(t,e,i){"use strict";i(800)},888:function(t,e,i){"use strict";i(801)},889:function(t,e,i){"use strict";i(802)},890:function(t,e,i){"use strict";i(803)},891:function(t,e,i){"use strict";i(804)},892:function(t,e,i){"use strict";i(805)},893:function(t,e,i){"use strict";i(806)},904:function(t,e,i){"use strict";i(816)},905:function(t,e,i){"use strict";i(817)},906:function(t,e,i){"use strict";i(818)},915:function(t,e,i){"use strict";i.r(e);var n=i(31),a=i(36);i(730),i(731),i(157),i(49),i(39),i(72),i(57);function s(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(c)throw s}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var l=Object(a.a)("gameCard"),m=l.mapState,u=l.mapActions,d={name:"CardHearthstone",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{loading:!0,faction_map:{Druid:"德鲁伊",Hunter:"猎人",Mage:"法师",Paladin:"圣骑士",Priest:"牧师",Rogue:"潜行者",Shaman:"萨满",Warlock:"术士",Warrior:"战士",Demonhunter:"恶魔猎手",Neutral:"中立盟军"},rarity_map:{"基本":"free","普通":"common","稀有":"rare","史诗":"epic","传说":"legend"},detail:{}}},computed:c({},m({visible:"visible"})),created:function(){this.getData()},mounted:function(){},beforeDestroy:function(){},methods:c(c({},u({setVisible:"setVisible"})),{},{closeDialog:function(){this.setVisible(!1)},getData:function(){var t=this,e=this;this.$apiRepository.card.getHearthstoneCard(this.card.id).then((function(t){e.handleData(t)})).catch((function(){t.loading=!1}))},generateShortCardRule:function(t){var e,i,n;if(void 0===t)return"";for(e=[/[\f\n\r\t\v]+/g,/\{+/g,/(\}\[)+/g,/\]+/g],i=["<br>",'<div class="key inline-block">','<p class="desc"><em></em>',"</p></div>"],n=0;n<e.length;n++)t=t.replace(e[n],i[n]);return t},handleRelatedCard:function(t){var e,i=this,n=this,a=[],r=s(t);try{var o=function(){var t=e.value,s=[];t.factions.split(",").map((function(t){s.push(n.faction_map[t])}));var r=s.join(",")+"-"+t.clazz+(t.race?"-"+t.race:"")+(t.attack<1&&t.hp<1?"":"（"+t.attack+" / "+t.hp+"）");a.push({img:t.img,cname:t.cname,cardType:r,rules:i.generateShortCardRule(t.rule)})};for(r.s();!(e=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}return a},handleData:function(t){var e=this;if(this.loading=!1,!t.success)return!1;var i=t.card,n=[];i.factions.split(",").map((function(t){n.push(e.faction_map[t])}));var a=n.join(",")+"-"+i.clazz+(i.race?"-"+i.race:"")+(i.attack<1&&i.hp<1?"":"（"+i.attack+" / "+i.hp+"）"),s={img:i.img,cname:i.cname,ename:i.ename,cardType:a,rules:this.generateShortCardRule(i.rule),desc:this.generateShortCardRule(i.description),mana:"https://static.iyingdi.com/static/images/tools/cards/hearthstone/mana/HS".concat(i.mana,".png"),rarity:"https://static.iyingdi.com/static/images/tools/cards/hearthstone/rarity/".concat(this.rarity_map[i.rarity],"_s.png"),forge:i.forge,goldForge:i.goldForge,decompose:i.decompose,goldDecompose:i.goldDecompose,artist:i.artist,seriesIndex:i.sindex,seriesSize:i.seriesSize,seriesName:i.seriesName,formatName:i.standard?"(标准)":"(狂野)",relatedCards:t.relatedCards?this.handleRelatedCard(t.relatedCards):null};this.detail=s}})},p=(i(887),i(20)),f=Object(p.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"炉石传说","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:t.closeDialog}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"detail-box"},[Object.keys(t.detail).length?i("section",[i("div",{staticClass:"info"},[i("div",{staticClass:"left"},[i("img",{staticClass:"image",attrs:{src:t.detail.img,alt:""}}),t._v(" "),i("ul",{staticClass:"dust"},[i("li",[i("span",[t._v("打造:")]),t._v(" "),i("span",[t._v(t._s(t.detail.forge))]),t._v(" /\n              "),i("span",{staticClass:"gold"},[t._v(t._s(t.detail.goldForge))])]),t._v(" "),i("li",[i("span",[t._v("分解:")]),t._v(" "),i("span",[t._v(t._s(t.detail.decompose))]),t._v(" /\n              "),i("span",{staticClass:"gold"},[t._v(t._s(t.detail.goldDecompose))])])])]),t._v(" "),i("div",{staticClass:"right"},[i("h3",{staticClass:"cname"},[t._v(t._s(t.detail.cname))]),t._v(" "),i("div",{staticClass:"ename"},[t._v(t._s(t.detail.ename))]),t._v(" "),i("div",{staticClass:"type"},[t._v(t._s(t.detail.cardType))]),t._v(" "),i("p",{staticClass:"rule",domProps:{innerHTML:t._s(t.detail.rules)}}),t._v(" "),i("div",{staticClass:"description",domProps:{innerHTML:t._s(t.detail.desc)}}),t._v(" "),i("div",{staticClass:"series"},[i("span",[t._v("画家："+t._s(t.detail.artist))]),t._v(" "),i("span",[t._v(t._s(t.detail.seriesName)+t._s(t.detail.formatName)+"："+t._s(t.detail.seriesIndex)+"/"+t._s(t.detail.seriesSize))])]),t._v(" "),i("img",{staticClass:"mana",attrs:{src:t.detail.mana}}),t._v(" "),i("img",{staticClass:"rarity",attrs:{src:t.detail.rarity}})])]),t._v(" "),t.detail.relatedCards?i("div",{staticClass:"related-cards"},[i("h3",{staticClass:"relate-title"},[t._v("相关卡牌")]),t._v(" "),i("ul",{staticClass:"relate-list flex"},t._l(t.detail.relatedCards,(function(e,n){return i("li",{key:n,staticClass:"relate-item"},[i("img",{staticClass:"inline-block align-top",attrs:{src:e.img,alt:""}}),t._v(" "),i("div",{staticClass:"inline-block align-top"},[i("p",[t._v(t._s(e.cname))]),t._v(" "),i("p",[t._v(t._s(e.cardType))]),t._v(" "),i("p",{domProps:{innerHTML:t._s(e.rules)}})])])})),0)]):t._e()]):i("div",{staticClass:"image-detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])])}),[],!1,null,"eefbec54",null).exports;i(71);function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var h=Object(a.a)("gameCard"),_=h.mapState,y=h.mapActions,b={name:"CardMagic",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{loading:!0,sameCards:[],sameActiveIndex:0,detail:{}}},computed:v({},_({visible:"visible"})),created:function(){this.getData()},mounted:function(){},beforeDestroy:function(){},methods:v(v({},y({setVisible:"setVisible"})),{},{closeDialog:function(){this.setVisible(!1)},getData:function(){var t=this,e=this;this.$apiRepository.card.getMagicCard(this.card.id).then((function(t){e.handleData(t.card),e.sameCards=t.sameCards})).catch((function(){t.loading=!1}))},generateCardRule:function(t){for(var e=[/[\f\n\r\t\v]+/g,/[\(（][^\(\)（）]*[\)）]/g,/\/(?=\w\})/g,/\{/g,/\}/g],i=["<p></p>","","",'<img src="https://static.iyingdi.com/static/images/tools/cards/magic/color/','.png" style="width: 14px;height:14px; vertical-align: middle; margin-right: 3px; display:inline">'],n=0;n<e.length;n++)t=t.replace(e[n],i[n]);return t},generateCardMana:function(t){var e,i,n=[];for(e=0;e<t.length;e++)i=t.charAt(e),n.push("https://static.iyingdi.com/yingdiWeb/images/tools/cards/magic/color/".concat(i,".png"));return n},generateCardFormat:function(t){for(var e={"-1":"_ban","-2":"_restrict",0:"",1:""},i=[],n=0,a=["t10","t15","t20","edh","historic","brawl","modern","pioneer"];n<a.length;n++){var s=a[n];i.push("https://static.iyingdi.com/yingdiWeb/images/tools/cards/magic/formatSquare/".concat(s).concat(e[t[s]],".png"))}return i},handleData:function(t){this.loading=!1;var e={img:t.img,cname:t.cname,ename:t.ename,cardType:"".concat(t.mainType).concat(t.subType.length>0?"-"+t.subType:""),rules:this.generateCardRule(t.rule),desc:this.generateCardRule(t.description),artist:t.artist,series:"".concat(t.seriesName,": ").concat(t.sindex," / ").concat(t.seriesSize),formats:this.generateCardFormat(t),mana:this.generateCardMana(t.mana),rarity:"https://static.iyingdi.com/card/magic/series/".concat(t.seriesAbbr,"/rarity/").concat(t.rarity,".png"),faq:t.faq};this.detail=e},sameTab:function(t){if(t===this.sameActiveIndex)return!1;this.sameActiveIndex=t,this.handleData(this.sameCards[t])}})},C=(i(888),Object(p.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"万智牌","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:t.closeDialog}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"detail-box"},[Object.keys(t.detail).length?i("section",[i("div",{staticClass:"info"},[i("div",{staticClass:"left"},[i("img",{staticClass:"image",attrs:{src:t.detail.img,alt:""}})]),t._v(" "),i("div",{staticClass:"center"},[i("h3",{staticClass:"cname"},[t._v(t._s(t.detail.cname))]),t._v(" "),i("div",{staticClass:"ename"},[t._v(t._s(t.detail.ename))]),t._v(" "),i("div",{staticClass:"type"},[t._v(t._s(t.detail.cardType))]),t._v(" "),i("p",{staticClass:"rule",domProps:{innerHTML:t._s(t.detail.rules)}}),t._v(" "),i("div",{staticClass:"description",domProps:{innerHTML:t._s(t.detail.desc)}}),t._v(" "),i("div",{staticClass:"series"},[i("span",[t._v("画家："+t._s(t.detail.artist))]),t._v(" "),i("span",[t._v(t._s(t.detail.series))])]),t._v(" "),i("div",{staticClass:"mana"},t._l(t.detail.mana,(function(t,e){return i("img",{key:e,attrs:{src:t,alt:""}})})),0),t._v(" "),i("img",{staticClass:"rarity",attrs:{src:t.detail.rarity}})]),t._v(" "),i("div",{staticClass:"right"},[i("h3",{staticClass:"format-title"},[t._v("可用赛制")]),t._v(" "),i("div",{staticClass:"format-images"},t._l(t.detail.formats,(function(t,e){return i("img",{key:e,attrs:{src:t,alt:""}})})),0)])]),t._v(" "),i("div",{staticClass:"same-box"},[i("h3",{staticClass:"same-title"},[t._v("其他版本")]),t._v(" "),i("ul",{staticClass:"same-list"},t._l(t.sameCards,(function(e,n){return i("li",{key:n,staticClass:"same-item",class:{active:n===t.sameActiveIndex},on:{click:function(e){return e.stopPropagation(),t.sameTab(n)}}},[i("img",{attrs:{src:"https://static.iyingdi.com/card/magic/series/"+e.seriesAbbr+"/rarity/"+e.rarity+".png",alt:""}}),t._v(" "),i("span",[t._v(" "+t._s(e.seriesName))])])})),0)]),t._v(" "),t.detail.faq?i("div",{staticClass:"faq-box"},[i("h3",{staticClass:"faq-title"},[t._v("规则FAQ")]),t._v(" "),i("p",[t._v(t._s(t.detail.faq))])]):t._e()]):i("div",{staticClass:"image-detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])])}),[],!1,null,"9e61a7a0",null).exports);function O(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){o=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw s}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function w(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?w(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var x=Object(a.a)("gameCard"),P=x.mapState,S=x.mapActions,I={name:"CardGwent",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{rarity_map:{Common:"普通",Rare:"稀有",Epic:"史诗",Legendary:"传奇"},rarity_color:{Common:"#646464",Rare:"#4A90E2",Epic:"#8466BD",Legendary:"#D87925"},faction_map:{Monsters:{value:"Monsters",text:"怪兽"},Northern:{value:"Northern",text:"北方领域"},Scoiatael:{value:"Scoiatael",text:"松鼠党"},Skellige:{value:"Skellige",text:"史凯利格"},Nilfgaard:{value:"Nilfgaard",text:"尼弗迦德"},Syndicate:{value:"Syndicate",text:"辛迪加"},Neutral:{value:"Neutral",text:"中立"}},type_map:{Bronze:"铜色",Silver:"银色",Gold:"金色",Leader:"领袖",Token:"衍生物"},loading:!0,relatedCards:[],detail:{}}},computed:k({},P({visible:"visible"})),created:function(){this.getData()},mounted:function(){},beforeDestroy:function(){},methods:k(k({},S({setVisible:"setVisible"})),{},{closeDialog:function(){this.setVisible(!1)},getData:function(){var t=this,e=this;this.$apiRepository.card.getGwentCard(this.card.id).then((function(i){e.handleData(i.card),t.handleRelatedCard(i.relatedCards||[])})).catch((function(){t.loading=!1}))},generateShortCardRule:function(t){var e,i,n;if(void 0===t)return"";for(e=[/[\f\n\r\t\v]+/g],i=["<br>"],n=0;n<e.length;n++)t=t.replace(e[n],i[n]);return t},handleRelatedCard:function(t){var e,i=O(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.relatedCards.push({img:n.img,cname:n.cname,attribute:n.attribute||"无",rules:this.generateShortCardRule(n.rule)})}}catch(t){i.e(t)}finally{i.f()}},handleData:function(t){this.loading=!1;var e={img:t.img,cname:t.cname,ename:t.ename,typee:this.type_map[t.typee],rules:this.generateShortCardRule(t.rule),faq:this.generateShortCardRule(t.faq),description:this.generateShortCardRule(t.description),faction:"https://static.iyingdi.com/yingdiWeb/images/tools/cards/gwent/faction/b/".concat(t.faction,".png"),factionText:this.faction_map[t.faction].text,rarityImg:"https://static.iyingdi.com/yingdiWeb/images/tools/cards/gwent/rarity/".concat(t.rarity,"-s.png"),rarityText:this.rarity_map[t.rarity],rarityColor:this.rarity_color[t.rarity],attribute:t.attribute||"无"};this.detail=e}})},$=(i(889),Object(p.a)(I,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"昆特牌","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:t.closeDialog}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"detail-box"},[Object.keys(t.detail).length?i("section",[i("div",{staticClass:"info"},[i("div",{staticClass:"left"},[i("img",{staticClass:"image",attrs:{src:t.detail.img,alt:""}})]),t._v(" "),i("div",{staticClass:"right"},[i("h3",{staticClass:"cname"},[t._v(t._s(t.detail.cname))]),t._v(" "),i("div",{staticClass:"ename"},[t._v(t._s(t.detail.ename))]),t._v(" "),i("div",{staticClass:"type"},[t._v(t._s(t.detail.typee))]),t._v(" "),i("p",{staticClass:"rule",domProps:{innerHTML:t._s(t.detail.rules)}}),t._v(" "),i("p",{staticClass:"faq rule",domProps:{innerHTML:t._s(t.detail.faq)}}),t._v(" "),i("p",{staticClass:"description",domProps:{innerHTML:t._s(t.detail.description)}}),t._v(" "),i("div",{staticClass:"attribute description"},[t._v("属性: "+t._s(t.detail.attribute))]),t._v(" "),i("div",{staticClass:"faction"},[i("img",{attrs:{src:t.detail.faction,alt:""}}),t._v(" "),i("span",[t._v(t._s(t.detail.factionText))])]),t._v(" "),i("div",{staticClass:"rarity",style:{color:t.detail.rarityColor}},[i("span",{staticClass:"text"},[t._v(t._s(t.detail.rarityText))]),t._v(" "),i("img",{attrs:{src:t.detail.rarityImg,alt:""}})])])]),t._v(" "),t.relatedCards.length?i("div",{staticClass:"related-cards"},[i("h3",{staticClass:"relate-title"},[t._v("相关卡牌")]),t._v(" "),i("ul",{staticClass:"relate-list flex"},t._l(t.relatedCards,(function(e,n){return i("li",{key:n,staticClass:"relate-item"},[i("img",{staticClass:"inline-block align-top",attrs:{src:e.img,alt:""}}),t._v(" "),i("div",{staticClass:"inline-block align-top"},[i("p",[t._v(t._s(e.cname))]),t._v(" "),i("p",[t._v(t._s(e.attribute))]),t._v(" "),i("p",{domProps:{innerHTML:t._s(e.rules)}})])])})),0)]):t._e()]):i("div",{staticClass:"image-detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])])}),[],!1,null,"fb275d8e",null).exports);function D(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return A(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){o=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw s}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function T(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function R(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?T(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var L=Object(a.a)("gameCard"),M=L.mapState,V=L.mapActions,N={name:"CardVerse",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{loading:!0,beforeCard:null,afterCard:null,relatedCards:[],evoActiveIndex:0,detail:{}}},computed:R({},M({visible:"visible"})),created:function(){this.getData()},mounted:function(){},beforeDestroy:function(){},methods:R(R({},V({setVisible:"setVisible"})),{},{closeDialog:function(){this.setVisible(!1)},getData:function(){var t=this,e=this;this.$apiRepository.card.getVerseCard(this.card.id).then((function(i){e.beforeCard=i.card,e.afterCard=i.envolveCard,e.handleData(e.beforeCard),t.handleRelatedCard(i.relatedCards||[])})).catch((function(){t.loading=!1}))},generateShortCardRule:function(t){var e,i,n;if(void 0===t)return"";for(e=[/[\f\n\r\t\v]+/g,/\{+/g,/(\}\[)+/g,/\]+/g],i=["<br>",'<div class="key inline-block">','<p class="desc"><em></em>',"</p></div>"],n=0;n<e.length;n++)t=t.replace(e[n],i[n]);return t},handleRelatedCard:function(t){var e,i=D(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,a="".concat(n.faction,"-").concat(n.mainType);this.relatedCards.push({img:n.img,cname:n.cname,cardType:a,rules:this.generateShortCardRule(n.crule)})}}catch(t){i.e(t)}finally{i.f()}},handleData:function(t){this.loading=!1;var e=t,i={img:e.img,cname:e.cname,jname:e.jname,ename:e.ename,cardType:"".concat(e.faction,"-").concat(e.mainType),rules:this.generateShortCardRule(e.crule),desc:this.generateShortCardRule(e.cdesc),mana:"https://static.iyingdi.com/yingdiWeb/images/tools/cards/verse/mana/".concat(e.mana,".png"),rarity:"https://static.iyingdi.com/yingdiWeb/images/tools/cards/verse/rarity/".concat(e.rarity,".png"),forge:e.forge>-1?e.forge:"无法打造",decompose:e.decompose>-1?e.decompose:"无法分解",cv:e.cv,seriesIndex:e.sindex,seriesSize:e.seriesSize,seriesName:e.seriesName,evo:"随从"===e.mainType};this.detail=i},evoTab:function(t){if(t===this.evoActiveIndex)return!1;this.evoActiveIndex=t,t?this.handleData(this.afterCard):this.handleData(this.beforeCard)}})},E=(i(890),Object(p.a)(N,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"影之诗","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:t.closeDialog}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"detail-box"},[Object.keys(t.detail).length?i("section",[i("div",{staticClass:"info"},[i("div",{staticClass:"left"},[i("img",{staticClass:"image",attrs:{src:t.detail.img,alt:""}}),t._v(" "),t.detail.evo?i("div",{staticClass:"evo"},[i("button",{class:{active:!t.evoActiveIndex},on:{click:function(e){return e.stopPropagation(),t.evoTab(0)}}},[t._v("进化前")]),t._v(" "),i("button",{class:{active:t.evoActiveIndex},on:{click:function(e){return e.stopPropagation(),t.evoTab(1)}}},[t._v("进化后")])]):t._e(),t._v(" "),i("ul",{staticClass:"dust"},[i("li",[i("span",[t._v("打造:")]),t._v(" "),i("span",[t._v(t._s(t.detail.forge))])]),t._v(" "),i("li",[i("span",[t._v("分解:")]),t._v(" "),i("span",[t._v(t._s(t.detail.decompose))])])])]),t._v(" "),i("div",{staticClass:"right"},[i("h3",{staticClass:"cname"},[t._v(t._s(t.detail.cname))]),t._v(" "),i("div",{staticClass:"ename"},[t._v(t._s(t.detail.ename))]),t._v(" "),i("div",{staticClass:"jname"},[t._v(t._s(t.detail.jname))]),t._v(" "),i("div",{staticClass:"type"},[t._v(t._s(t.detail.cardType))]),t._v(" "),i("p",{staticClass:"rule",domProps:{innerHTML:t._s(t.detail.rules)}}),t._v(" "),i("div",{staticClass:"description",domProps:{innerHTML:t._s(t.detail.desc)}}),t._v(" "),i("div",{staticClass:"series"},[i("span",[t._v("声优："+t._s(t.detail.cv))]),t._v(" "),i("span",[t._v(t._s(t.detail.seriesName)+"："+t._s(t.detail.seriesIndex)+"/"+t._s(t.detail.seriesSize))])]),t._v(" "),i("img",{staticClass:"mana",attrs:{src:t.detail.mana}}),t._v(" "),i("img",{staticClass:"rarity",attrs:{src:t.detail.rarity}})])]),t._v(" "),t.relatedCards.length?i("div",{staticClass:"related-cards"},[i("h3",{staticClass:"relate-title"},[t._v("相关卡牌")]),t._v(" "),i("ul",{staticClass:"relate-list flex"},t._l(t.relatedCards,(function(e,n){return i("li",{key:n,staticClass:"relate-item"},[i("img",{staticClass:"inline-block align-top",attrs:{src:e.img,alt:""}}),t._v(" "),i("div",{staticClass:"inline-block align-top"},[i("p",[t._v(t._s(e.cname))]),t._v(" "),i("p",[t._v(t._s(e.cardType))]),t._v(" "),i("p",{domProps:{innerHTML:t._s(e.rules)}})])])})),0)]):t._e()]):i("div",{staticClass:"image-detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])])}),[],!1,null,"252862f1",null).exports);function U(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function z(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var H=Object(a.a)("gameCard"),q=H.mapState,F=H.mapActions,W={name:"CardHundred",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{}},computed:z({},q({visible:"visible"})),created:function(){},mounted:function(){},beforeDestroy:function(){},methods:z({},F({setVisible:"setVisible"}))},B=(i(891),Object(p.a)(W,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"百闻牌","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:function(e){return t.setVisible(!1)}}},[i("div",{staticClass:"detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])}),[],!1,null,"01eb29eb",null).exports);function J(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function G(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?J(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Q=Object(a.a)("gameCard"),K=Q.mapState,X=Q.mapActions,Y={name:"CardLor",components:{},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{}},computed:G({},K({visible:"visible"})),created:function(){},mounted:function(){},beforeDestroy:function(){},methods:G({},X({setVisible:"setVisible"}))},Z=(i(892),Object(p.a)(Y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"符文之地","custom-class":"card-item-box",visible:t.visible,"lock-scroll":!1},on:{close:function(e){return t.setVisible(!1)}}},[i("div",{staticClass:"detail-box"},[i("div",{staticClass:"card-image"},[i("img",{attrs:{src:t.card.imageSrc,alt:""}})])])])}),[],!1,null,"61270646",null).exports);function tt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var et=Object(a.a)("gameCard").mapState,it={name:"CardDetail",components:{hearthstone:f,magic:C,gwent:$,verse:E,hundred:B,lor:Z},props:{card:{type:Object,default:function(){return{id:0,game:"",imageSrc:""}}}},data:function(){return{}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):tt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},et({visible:"visible"})),created:function(){},mounted:function(){},methods:{}},nt=(i(893),Object(p.a)(it,(function(){var t=this.$createElement,e=this._self._c||t;return this.visible?e("div",{staticClass:"animate__fadeIn card-detail-box"},[e(this.card.game,{tag:"component",attrs:{card:this.card}})],1):this._e()}),[],!1,null,"3eec2b54",null));e.default=nt.exports},926:function(t,e,i){"use strict";i.r(e);i(94),i(157),i(49),i(93),i(39),i(72),i(57);var n=i(31),a=i(36);function s(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(c)throw s}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var l={name:"CommentItem",components:{},props:{commentInfo:{type:Object,default:function(){return{}}},ifReply:{type:Boolean,default:!1},postType:{type:Number,default:function(){return 11}}},data:function(){return{action:this.commentInfo.main_comment.action,replyVisible:!1,ifUpdate:!1,reportModalVisible:!1,previewImages:{list:[],options:{}}}},computed:c(c({},Object(a.d)("tag",["tempPostTagList"])),{},{user:function(){return this.commentInfo.main_comment.user},comment:function(){return this.commentInfo.main_comment.comment},imgList:function(){return Array.isArray(this.commentInfo.main_comment.comment.imgs)?this.commentInfo.main_comment.comment.imgs:this.commentInfo.main_comment.comment.imgs?this.commentInfo.main_comment.comment.imgs.split(/[;`]/).sort():[]},reply_comments:function(){return this.commentInfo.reply_comments?this.commentInfo.reply_comments:[]},last_reply_num:function(){var t=this.comment.reply_num,e=this.reply_comments.length;return t-e<0?0:t-e},vote_faction_data:function(){return!![15].includes(this.postType)&&(this.$utils.checkIsJSON(this.comment.vote_json)?JSON.parse(this.comment.vote_json):{})},hasAuth:function(){return this.$store.getters.userInfo.id===this.user.id}}),watch:{},created:function(){},mounted:function(){this.setPreviewImage()},methods:{like:function(){var t=this;if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;var e=this.comment.like_num,i=0;i=0===this.action?1:-1;var n={comment_id:this.comment.id,post_id:this.comment.source_id,action:i};this.$apiRepository.comment.likeComment(n).then((function(){0===t.action?(e+=1,t.action=1):(e-=1,t.action=0),t.$set(t.comment,"like_num",e)})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})})),window.AnalysysAgent.track("post_detail_like_comment",{comment_id:"".concat(this.comment.id),comment_user_id:"".concat(this.user.id),post_id:"".concat(this.$route.params.id)})},hate:function(){var t=this;if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;var e=0;e=0===this.action?2:-2;var i={comment_id:this.comment.id,post_id:this.comment.source_id,action:e};this.$apiRepository.comment.likeComment(i).then((function(){0===t.action?t.action=2:t.action=0})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})})),window.AnalysysAgent.track("post_detail_dislike_comment",{comment_id:"".concat(this.comment.id),comment_user_id:"".concat(this.user.id),post_id:"".concat(this.$route.params.id)})},reply:function(){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;this.ifUpdate=!1,this.replyVisible=!this.replyVisible},sendReply:function(t){var e=this,i={post_id:this.comment.source_id,parent_id:this.comment.id,anonymous:0,content:t.content,imgs:t.imgs.join("`")};this.$apiRepository.comment.createComment(i).then((function(t){e.$message({type:"success",message:"发表成功",offset:300}),e.reply_comments.unshift(t),e.replyVisible=!e.replyVisible})).catch((function(t){e.$message.error(t.response.data.retMsg)}))},update:function(){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;this.ifUpdate=!0,this.replyVisible=!this.replyVisible},updateReply:function(t){var e=this,i={comment_id:this.comment.id,post_id:this.comment.source_id,content:t.content,imgs:t.imgs.join("`")};this.$apiRepository.limit.modifyComment(i).then((function(){e.comment.content=t.content,e.comment.imgs=t.imgs,e.replyVisible=!1,e.setPreviewImage()})).catch((function(t){e.$message({type:"warning",message:t.response.data.retMsg,offset:300})}))},remove:function(){var t=this;this.$apiRepository.limit.deleteComment(this.comment.id).then((function(){t.$message({type:"success",message:"删除成功",offset:300}),t.comment.content="评论已删除",t.comment.imgs=""})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})}))},report:function(){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;this.reportModalVisible=!0},addReplayComment:function(t){this.reply_comments.unshift(t)},getAllReply:function(){var t=this,e={comment_id:this.comment.id,size:10,last_reply_id:this.reply_comments[this.reply_comments.length-1].comment.id,order:"desc"};this.$apiRepository.comment.getChildCommentList(e).then((function(e){t.reply_comments.push.apply(t.reply_comments,e.reply_comments)})).catch((function(t){}))},setPreviewImage:function(){if(!this.imgList||!this.imgList.length)return!1;var t=this;this.previewImages.list=[];var e,i=s(this.imgList);try{var n=function(){var i=e.value,n=new Image;n.src=i,n.onload=function(){t.previewImages.list.push({msrc:i,src:i,w:n.width,h:n.height})}};for(i.s();!(e=i.n()).done;)n()}catch(t){i.e(t)}finally{i.f()}},previewImageShow:function(t){var e=0;this.previewImages.list.map((function(i,n){i.src===t&&(e=n)})),this.$refs.imagePreviewer.show(e)}}},m=(i(905),i(20)),u=Object(m.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-item-component"},[i("div",{staticClass:"relative"},[i("UserTitle",{attrs:{user:t.user}}),t._v(" "),t.vote_faction_data?i("div",{staticClass:"vote-faction text-sm leading-none absolute bottom-20 right-0",class:"_"+t.vote_faction_data.faction},[t._v("\n      "+t._s(t.vote_faction_data.content)+"\n    ")]):t._e()],1),t._v(" "),i("div",{staticClass:"item-content-area"},[i("div",[i("div",{staticClass:"text-base text-gray-800 leading-6 break-all",domProps:{innerHTML:t._s(t.comment.content)}}),t._v(" "),t.imgList.length>0?i("div",{staticClass:"item-content-imgs"},t._l(t.imgList,(function(e,n){return i("div",{key:""+t.comment.id+n,staticClass:"img-item",style:{backgroundImage:"url("+e+")"},on:{click:function(i){return t.previewImageShow(e)}}})})),0):t._e(),t._v(" "),i("div",{staticClass:"foot"},[i("div",{staticClass:"flex flex-row items-center"},[i("span",[t._v(t._s(t._f("formatTime")(t.comment.created)))]),t._v(" "),i("div",{staticClass:"ml-20 space-x-1"},[t.hasAuth?i("div",{staticClass:"inline"},[i("a",{staticClass:"text-blue-500 cursor-pointer",on:{click:t.update}},[t._v("修改")]),t._v(" "),i("a",{staticClass:"text-blue-500 cursor-pointer",on:{click:t.remove}},[t._v("删除")])]):i("div",{staticClass:"inline"},[i("a",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.modifyComment},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.modifyComment }"}],staticClass:"text-blue-500 cursor-pointer",on:{click:t.update}},[t._v("修改")]),t._v(" "),i("a",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.deleteComment},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.deleteComment }"}],staticClass:"text-blue-500 cursor-pointer",on:{click:t.remove}},[t._v("删除")])]),t._v(" "),i("a",{staticClass:"cursor-pointer",on:{click:t.report}},[t._v("举报")])])]),t._v(" "),t.comment.id?i("div",{staticClass:"flex flex-row justify-between items-center"},[i("transition",{attrs:{name:"like","enter-active-class":"animate__animated animate__faster animate__zoomIn","leave-active-class":"animate__animated animate__faster animate__zoomOut",mode:"out-in"}},[1===t.action?i("a",{key:"a-1",staticClass:"mr-20 px-15 py-2 bg-red-600 rounded-3xl text-white",on:{click:t.like}},[i("SvgIcon",{attrs:{"icon-class":"fire"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.like_num?t.comment.like_num:"点火"))])],1):2===t.action?i("a",{key:"a-2",staticClass:"mr-20 px-20 py-2 bg-blue-500 rounded-3xl text-white",on:{click:t.hate}},[i("SvgIcon",{attrs:{"icon-class":"water"}})],1):i("a",{key:"a-3",staticClass:"mr-20 px-15 py-2 bg-gray-100 rounded-3xl"},[i("span",{staticClass:"cursor-pointer",on:{click:t.like}},[i("SvgIcon",{attrs:{"icon-class":"fire"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.like_num?t.comment.like_num:"点火"))])],1),t._v(" "),i("span",{staticClass:"mx-10 text-gray-D8"},[t._v("|")]),t._v(" "),i("span",{staticClass:"text-center cursor-pointer",on:{click:t.hate}},[i("SvgIcon",{attrs:{"icon-class":"water"}})],1)])]),t._v(" "),i("a",{staticClass:"px-15 py-2 bg-gray-100 rounded-3xl cursor-pointer",on:{click:t.reply}},[i("SvgIcon",{attrs:{"icon-class":"comment"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.reply_num?t.comment.reply_num:"回复"))])],1)],1):t._e()]),t._v(" "),t.replyVisible?i("CommentInput",{staticClass:"mt-20",attrs:{"if-update":t.ifUpdate,comment:t.comment},on:{send:t.sendReply,modify:t.updateReply}}):t._e()],1),t._v(" "),i("div",{staticClass:"children-content-area"},[i("div",{staticClass:"comment-childs"},t._l(t.reply_comments,(function(e,n){return i("CommentChildItem",{key:""+e.comment.id+n,attrs:{"reply-comment":e},on:{addReplay:t.addReplayComment}})})),1),t._v(" "),t.last_reply_num?i("div",{staticClass:"unfold-more-btn",on:{click:function(e){return e.stopPropagation(),t.getAllReply(e)}}},[t._v("\n        "+t._s("剩余"+t.last_reply_num+"条，展开更多")+"\n      ")]):t._e()])]),t._v(" "),i("ReportModal",{attrs:{visible:t.reportModalVisible,"source-id":t.comment.id,"source-type":2},on:{"update:visible":function(e){t.reportModalVisible=e}}}),t._v(" "),i("client-only",[i("ImagePreviewer",{ref:"imagePreviewer",attrs:{list:t.previewImages.list,options:t.previewImages.options}})],1)],1)}),[],!1,null,"674df5a4",null);e.default=u.exports;installComponents(u,{UserTitle:i(733).default,SvgIcon:i(74).default,CommentInput:i(746).default,CommentChildItem:i(939).default,ReportModal:i(748).default})},939:function(t,e,i){"use strict";i.r(e);i(157),i(49),i(73),i(39),i(72),i(57);var n=i(31),a=i(36);function s(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(c)throw s}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var c={name:"CommentChildItem",components:{},props:{replyComment:{type:Object,default:function(){return{}}}},data:function(){return{people_link:"".concat(this.$settings.routePre,"/people/"),action:this.replyComment.action,replyVisible:!1,ifUpdate:!1,reportModalVisible:!1,previewImages:{list:[],options:{}}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({comment:function(){return this.replyComment.comment},formatUser:function(){var t=this.replyComment.user,e=this.$utils.checkIsJSON(t.badge_json)?JSON.parse(t.badge_json):{},i=this,n=e.badges||[];return n.length>3&&(n=e.badges.slice(0,3)),{id:t.id,name:t.nickname||t.username,avatar:t.avatar||t.head,level:this.$utils.getUserLevel(t.credits_score||t.credits),get levelImg(){return i.$utils.getLevelImg(this.level)},nameColor:e.name_color||e.color,border:e.border||e.defaultBorder||"".concat("https://pic.iyingdi.com","/yingdi_mobile/user/border/normal.png"),badges:n}},receiver:function(){return{reId:this.replyComment.comment.receiver_id,reName:this.replyComment.comment.receiver_name}},imgList:function(){return Array.isArray(this.comment.imgs)?this.comment.imgs:this.comment.imgs?this.comment.imgs.split(/[;`]/).sort():[]},hasAuth:function(){return this.$store.getters.userInfo.id===this.formatUser.id}},Object(a.d)("tag",["tempPostTagList"])),created:function(){},mounted:function(){this.setPreviewImage()},beforeDestroy:function(){},methods:{reply:function(t){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;this.ifUpdate=t,this.replyVisible=!this.replyVisible},sendReply:function(t){var e=this,i={post_id:this.comment.source_id,parent_id:this.comment.id,anonymous:0,content:t.content,imgs:t.imgs.join("`")};this.$apiRepository.comment.createComment(i).then((function(t){e.$message({type:"success",message:"发表成功",offset:300}),e.replyVisible=!1,e.$emit("addReplay",t)})).catch((function(t){e.$message.error(t.response.data.retMsg)}))},updateReply:function(t){var e=this,i={comment_id:this.comment.id,post_id:this.comment.source_id,content:t.content,imgs:t.imgs.join("`")};this.$apiRepository.limit.modifyComment(i).then((function(){e.comment.content=t.content,e.comment.imgs=t.imgs,e.replyVisible=!1,e.setPreviewImage()})).catch((function(t){e.$message({type:"warning",message:t.response.data.retMsg,offset:300})}))},like:function(){var t=this;if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;var e=this.comment.like_num,i=0;i=0===this.action?1:-1;var n={comment_id:this.comment.id,post_id:this.comment.source_id,action:i};this.$apiRepository.comment.likeComment(n).then((function(){0===t.action?(e+=1,t.action=1):(e-=1,t.action=0),t.$set(t.comment,"like_num",e)})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})}))},hate:function(){var t=this;if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;var e=0;e=0===this.action?2:-2;var i={comment_id:this.comment.id,post_id:this.comment.source_id,action:e};this.$apiRepository.comment.likeComment(i).then((function(){0===t.action?t.action=2:t.action=0})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})}))},remove:function(){var t=this;this.$apiRepository.limit.deleteComment(this.comment.id).then((function(){t.$message({type:"success",message:"删除成功",offset:300}),t.comment.content="评论已删除",t.comment.imgs=""})).catch((function(e){t.$message({type:"warning",message:e.response.data.retMsg,offset:300})}))},report:function(){if(!this.$store.getters.token)return this.$router.replace("".concat(this.$settings.routePre,"/login")),!1;this.reportModalVisible=!0},setPreviewImage:function(){if(!this.imgList||!this.imgList.length)return!1;var t=this;this.previewImages.list=[];var e,i=s(this.imgList);try{var n=function(){var i=e.value,n=new Image;n.src=i,n.onload=function(){t.previewImages.list.push({msrc:i,src:i,w:n.width,h:n.height})}};for(i.s();!(e=i.n()).done;)n()}catch(t){i.e(t)}finally{i.f()}},previewImageShow:function(t){var e=0;this.previewImages.list.map((function(i,n){i.src===t&&(e=n)})),this.$refs.childImagePreviewer.show(e)}}},l=(i(906),i(20)),m=Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-child-box"},[i("div",{staticClass:"user-box"},[i("a",{staticClass:"avatar-box block",attrs:{href:t.people_link+t.formatUser.id,target:"_blank"}},[i("img",{staticClass:"avatar",attrs:{src:t.formatUser.avatar,alt:""}}),t._v(" "),i("img",{staticClass:"decoration",attrs:{src:t.formatUser.border,alt:""}})]),t._v(" "),i("div",{staticClass:"info-box"},[i("div",{staticClass:"name"},[i("a",{style:{color:t.formatUser.nameColor},attrs:{href:t.people_link+t.formatUser.id,target:"_blank"}},[t._v(t._s(t.formatUser.name))]),t._v(" "),Number(t.receiver.reId)>0?i("a",{attrs:{href:t.people_link+t.receiver.reId,target:"_blank"}},[i("i",{staticClass:"text-blue-550 transform rotate-90 inline-block"},[i("svg-icon",{attrs:{"icon-class":"arrow"}})],1),t._v("\n          "+t._s(t.receiver.reName)+"\n        ")]):t._e()]),t._v(" "),i("ul",{staticClass:"honor"},[i("li",{staticClass:"level",style:{backgroundImage:"url("+t.formatUser.levelImg+")"}},[t._v("Lv. "+t._s(t.formatUser.level))]),t._v(" "),t._l(t.formatUser.badges,(function(t,e){return i("li",{key:e,staticClass:"badge"},[i("img",{attrs:{src:t,alt:""}})])}))],2)])]),t._v(" "),i("div",{staticClass:"child-content"},[i("p",{staticClass:"text-base text-gray-800 leading-6 break-all",domProps:{innerHTML:t._s(t.comment.content)}}),t._v(" "),t.imgList.length>0?i("div",{staticClass:"images-box"},t._l(t.imgList,(function(e,n){return i("div",{key:n,staticClass:"image-item",style:{backgroundImage:"url("+e+")"},on:{click:function(i){return t.previewImageShow(e)}}})})),0):t._e(),t._v(" "),i("div",{staticClass:"foot"},[i("div",{staticClass:"flex flex-row items-center"},[i("span",[t._v(t._s(t._f("formatTime")(t.comment.created)))]),t._v(" "),i("div",{staticClass:"ml-20 space-x-1"},[t.hasAuth?i("div",{staticClass:"inline"},[i("a",{staticClass:"text-blue-500 cursor-pointer",on:{click:function(e){return t.reply(!0)}}},[t._v("修改")]),t._v(" "),i("a",{staticClass:"text-blue-500 cursor-pointer",on:{click:t.remove}},[t._v("删除")])]):i("div",{staticClass:"inline"},[i("a",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.modifyComment},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.modifyComment }"}],staticClass:"text-blue-500 cursor-pointer",on:{click:function(e){return t.reply(!0)}}},[t._v("修改")]),t._v(" "),i("a",{directives:[{name:"permission",rawName:"v-permission",value:{tags:t.tempPostTagList,action:t.$settings.role_action_map.deleteComment},expression:"{ tags: tempPostTagList, action: $settings.role_action_map.deleteComment }"}],staticClass:"text-blue-500 cursor-pointer",on:{click:t.remove}},[t._v("删除")])]),t._v(" "),i("a",{staticClass:"cursor-pointer",on:{click:t.report}},[t._v("举报")])])]),t._v(" "),t.comment.id?i("div",{staticClass:"flex flex-row justify-between items-center"},[i("transition",{attrs:{name:"like","enter-active-class":"animate__animated animate__faster animate__zoomIn","leave-active-class":"animate__animated animate__faster animate__zoomOut",mode:"out-in"}},[1===t.action?i("a",{key:"a-1",staticClass:"mr-20 px-15 py-2 bg-red-600 rounded-3xl text-white",on:{click:t.like}},[i("SvgIcon",{attrs:{"icon-class":"fire"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.like_num?t.comment.like_num:"点火"))])],1):2===t.action?i("a",{key:"a-2",staticClass:"mr-20 px-20 py-2 bg-blue-500 rounded-3xl text-white",on:{click:t.hate}},[i("SvgIcon",{attrs:{"icon-class":"water"}})],1):i("a",{key:"a-3",staticClass:"mr-20 px-15 py-2 bg-gray-100 rounded-3xl"},[i("span",{staticClass:"cursor-pointer",on:{click:t.like}},[i("SvgIcon",{attrs:{"icon-class":"fire"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.like_num?t.comment.like_num:"点火"))])],1),t._v(" "),i("span",{staticClass:"mx-10 text-gray-D8"},[t._v("|")]),t._v(" "),i("span",{staticClass:"text-center cursor-pointer",on:{click:t.hate}},[i("SvgIcon",{attrs:{"icon-class":"water"}})],1)])]),t._v(" "),i("a",{staticClass:"px-15 py-2 bg-gray-100 rounded-3xl cursor-pointer",on:{click:function(e){return t.reply(!1)}}},[i("SvgIcon",{attrs:{"icon-class":"comment"}}),t._v(" "),i("span",{staticClass:"inline-block w-9 text-center"},[t._v(t._s(t.comment.reply_num?t.comment.reply_num:"回复"))])],1)],1):t._e()]),t._v(" "),t.replyVisible?i("CommentInput",{staticClass:"mt-20",attrs:{"if-update":t.ifUpdate,comment:t.comment},on:{send:t.sendReply,modify:t.updateReply}}):t._e()],1),t._v(" "),i("ReportModal",{attrs:{visible:t.reportModalVisible,"source-id":t.comment.id,"source-type":2},on:{"update:visible":function(e){t.reportModalVisible=e}}}),t._v(" "),i("client-only",[i("ImagePreviewer",{ref:"childImagePreviewer",attrs:{list:t.previewImages.list,options:t.previewImages.options}})],1)],1)}),[],!1,null,"8c4d78fc",null);e.default=m.exports;installComponents(m,{SvgIcon:i(74).default,SvgIcon:i(74).default,CommentInput:i(746).default,ReportModal:i(748).default})}}]);